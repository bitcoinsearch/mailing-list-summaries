<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>New transaction policies (nVersion=3) for contracting protocols</title>
  <updated>2023-07-07T02:28:55.209813+00:00</updated>
  <author>
    <name>Greg Sanders 2023-06-21 20:57:45+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>New transaction policies (nVersion=3) for contracting protocols</title>
    <updated>2023-07-07T02:28:55.209858+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021780.html" rel="alternate"/>
    <summary>This proposal suggests a set of mempool/transaction relay policies to aid L2/contract protocols. The proposed policies aim to solve the problem of Rule 3 pinning and potentially eliminate the need for CPFP carve-out. The policies include additional rules for V3 transactions and modifications to package RBF rules.Under the new policies, V3 transactions can be replaced, even if they do not signal BIP125 replaceability. This allows for inherited replaceability signaling when descendants of unconfirmed transactions are created. An unconfirmed V3 transaction cannot have more than one descendant, which prevents a pinning attack where a malicious counterparty adds many descendant transactions that aren't fee-bumping. Additionally, a V3 transaction with an unconfirmed V3 ancestor cannot be larger than 1000 virtual bytes. This sets an upper bound on the size of the descendant, ensuring that the cost of replacing a V3 transaction has lower variance.These policies also modify the package RBF rules. The rule regarding unconfirmed inputs states that a package may include new unconfirmed inputs, but the ancestor feerate of the child must be at least as high as the ancestor feerate of the parent. This ensures that the child transaction does not decrease the overall feerate of the package.The proposal includes rationale for each rule, explaining the motivations behind them. It also addresses potential concerns and discusses possible optimizations, such as allowing OP_TRUE to become a standard script type and allowing for a single dust-value output for anchors.The implementation for these policies has been provided in the Bitcoin Core repository, and feedback from the community is encouraged. The proposal emphasizes that existing transactions that were standard before this policy change will still be standard afterward.The Bitcoin development mailing list has recently discussed proposed changes to the Bitcoin transaction replacement policy. The aim of these changes is to ensure that replacement transactions are not less incentive-compatible to mine. One of the proposed rules states that the minimum between the package feerate and the ancestor feerate of the child should not be lower than the individual feerates of all directly conflicting transactions and the ancestor feerates of all original transactions. This modification is considered more conservative than the original proposal, as it takes into account the package feerate and the ancestor feerate of the child.Another new rule requires that all package transactions with mempool conflicts must be V3. This means that the "sponsoring" child transaction must also be V3. This rule ensures that only V3 transactions can pay to replace their ancestors' conflicts, and only V3 transactions' replacements may be paid for by a descendant. The rationale behind this rule is that the fee-related rules are economically rational for ancestor packages, but not necessarily for other types of packages. By restricting the type of transactions that can replace their ancestors' conflicts, it becomes easier to apply the descendant limits correctly.The intended usage for Lightning Network (LN) transactions is also discussed. Commitment transactions in LN should be V3 and have 1 anchor output. These transactions can be signed with 0 fees or 1sat/vbyte once package relay is deployed on a significant portion of the network. If the commitment transaction needs to be broadcasted, the desired feerate can be determined at broadcast time and the anchor output can be spent in a high feerate transaction. The broadcasted commitment transaction is referred to as "the parent" and the attached fee-bumping transaction as "the child". Several rules and restrictions are outlined for the child transaction, including being V3, having a maximum size of 1000vB, and limitations on the number of inputs that can be used to fund the fee bump.The proposed changes also address potential questions and concerns. It is stated that the V3 descendant limit fixes Rule 3 Pinning and restricts both the user and counterparty. It is clarified that fee-bumping a counterparty's commitment transaction using child-pays-for-parent (CPFP) is not necessary, as the commitment transaction can be replaced by attaching a high-feerate child transaction. The issue of privacy and fingerprinting LN transactions based on nVersion is also addressed, with the understanding that V3 transactions may not be widely used outside of Layer 2 (L2). The compatibility of V3 and V2 transactions is discussed, with the requirement that V3 transactions cannot replace V2 transactions to prevent censorship of V2 transactions spending shared inputs.Overall, these proposed changes aim to improve the Bitcoin transaction replacement policy and ensure incentive compatibility for replacement transactions. Feedback and review are welcomed on these proposals.</summary>
    <published>2023-06-21T20:57:45+00:00</published>
  </entry>
</feed>
