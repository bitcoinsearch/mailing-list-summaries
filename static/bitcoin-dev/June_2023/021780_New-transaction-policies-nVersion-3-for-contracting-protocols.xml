<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>New transaction policies (nVersion=3) for contracting protocols</title>
  <updated>2023-07-01T02:41:51.062229+00:00</updated>
  <author>
    <name>Greg Sanders 2023-06-21 20:57:45+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>New transaction policies (nVersion=3) for contracting protocols</title>
    <updated>2023-07-01T02:41:51.062276+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021780.html" rel="alternate"/>
    <summary>In a recent proposal by Gloria Zhao, a set of mempool/transaction relay policies are suggested to aid L2/contract protocols. The proposal aims to solve the problem of Rule 3 pinning and potentially eliminate the need for CPFP carve-out.The proposed policies include additional rules for V3 transactions and modifications to package RBF rules. For V3 transactions, which are currently non-standard in Bitcoin Core, several additional rules are introduced. Firstly, a V3 transaction can be replaced even if it does not signal BIP125 replaceability, as long as it meets other RBF rules such as fees. This allows for inherited replaceability signaling when descendants of unconfirmed transactions are created. Additionally, an unconfirmed V3 transaction cannot have more than one descendant, limiting the potential for pinning attacks. Furthermore, a V3 transaction with an unconfirmed V3 ancestor cannot be larger than 1000 virtual bytes. These rules aim to strike a balance between allowing fee-bumping and preventing abuse.As for package RBF modifications, the rule regarding unconfirmed inputs is adjusted. Previously, a package could include new unconfirmed inputs, but the ancestor feerate of the child had to be at least as high as the ancestor feerate of the package. With the proposed modifications, this requirement is removed, allowing for greater flexibility in constructing packages.The proposal also includes some suggestions made by Greg Sanders. One suggestion is to consider allowing OP_TRUE to become a standard script type, which would save bytes by eliminating the need for witness data when binding an anchor to a specific wallet/user. Another suggestion is to allow for a single dust-value output that is immediately spent by the package, making anchors easier to design.Overall, the proposed set of mempool/transaction relay policies provides a simple solution to address Rule 3 pinning and improve the functionality of L2/contract protocols. It introduces additional rules for V3 transactions and modifies package RBF rules to enhance flexibility and efficiency.The Bitcoin Core mailing list recently discussed proposed changes to the Bitcoin protocol regarding transaction replacement rules. The first change involves modifying the rule for determining the minimum fee rate for replacement transactions. Instead of using the ancestor fee rate, the new rule suggests using the minimum between the package fee rate and the ancestor fee rate of the child. This modification aims to ensure that replacement transactions are not less incentive-compatible to mine.The second change introduces a new rule requiring all package transactions with mempool conflicts to be Version 3 (V3). This means that both the conflicting transactions and their replacements must adhere to V3 rules. This requirement ensures that only V3 transactions can pay to replace their ancestors' conflicts, creating a child-with-parents package validation system.These changes were proposed to address economic rationality concerns for ancestor packages and to simplify the validation process. By restricting package validation to V3 transactions, it becomes easier to apply descendant limits correctly. Additionally, the new rules prevent potential issues when the sponsor is not a direct descendant of the sponsee.For users of the Lightning Network (LN), commitment transactions should also be V3 and have one anchor output. These commitment transactions can initially be signed with no fees or a low fee rate, as long as package relay is deployed on a significant portion of the network. If the commitment transaction needs to be broadcasted, users can determine the desired fee rate at broadcast time and spend the anchor output in a high fee rate transaction. This broadcasted commitment transaction is referred to as "the parent," while the attached fee-bumping transaction is called "the child." It is important to note that the child must be V3 and have a size of at most 1000vB.The V3 descendant limit imposes restrictions on both users and their counterparties, effectively fixing Rule 3 Pinning. Users can assume that they only need to replace the commitment transaction and up to 1000vB, given that nodes adopt this policy. In cases where users need to bump a counterparty's commitment transaction in the mempool, they can package RBF (Replace-By-Fee) it by attaching a high fee rate child to their own commitment transaction.Regarding privacy concerns, the use of V3 transactions may not be widespread outside of the LN, so it should not significantly impact fingerprinting LN transactions based on nVersion. Additionally, V3 transactions that do not signal BIP125 replaceability are replaceable, but this is not considered a backward compatibility issue since those transactions would not have been in the mempool under the previous policy.To prevent potential censorship of V2 transactions spending shared inputs, V2 transactions can replace V3 transactions and vice versa. However, if the original V3 transaction has an unconfirmed V3 parent, it would violate the "inherited V3" rule and be rejected.The proposed changes to the Bitcoin protocol aim to improve the incentive compatibility of replacement transactions, simplify validation processes for packages, and ensure proper handling of commitment transactions within the Lightning</summary>
    <published>2023-06-21T20:57:45+00:00</published>
  </entry>
</feed>
