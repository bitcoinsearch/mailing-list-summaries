<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
  <updated>2023-10-17T01:54:46.122437+00:00</updated>
  <author>
    <name>Antoine Riard 2023-10-16 16:57:36+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
    <updated>2023-10-17T01:54:46.122476+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-October/021999.html" rel="alternate"/>
    <summary>A recent technical discussion uncovered a new attack called replacement cycling, which targets lightning channels. This attack can lead to the loss of funds and affects both legacy and anchor output channels. Mitigations for this attack have been implemented by major lightning implementations such as LDK, Eclair, LND, and Core-Lightning. These mitigations can be found in their respective release numbers.In the attack, a malicious channel counterparty broadcasts an HTLC-preimage transaction with a higher fee and feerate than the victim's honest HTLC-timeout. This triggers a replacement, evicting the honest HTLC-timeout from the mempool. The attacker can then replace the parent transaction itself with another candidate, further evicting the malicious HTLC-preimage. Although no replacement cycling attacks have been observed, a functional test is available to simulate the attack.To mitigate this attack, several measures have been implemented. Aggressive rebroadcasting increases the absolute fee cost for the attacker. Local-mempool preimage monitoring allows the honest lightning node to catch the unconfirmed HTLC-preimage before its replacement. Adjusting the CLTV Expiry Delta setting can also increase the odds of success against a replacement cycling attack.The email also highlights the potential impact of replacement cycling attacks on other bitcoin applications using timelocks or multi-party transactions. Developers, maintainers, and operators of these applications are encouraged to investigate how these attacks might disrupt their transactions or fee-bumping flows.Package malleability pinning attacks and the challenges posed by replacement cycling attacks are also discussed. Efforts have been made to mitigate pinning attacks at the mempool level, but replacement cycling introduces new challenges.The timeline of events leading up to the full disclosure of the attack is mentioned, with mitigations already implemented and released, and CVEs assigned. The full disclosure of the replacement cycling attacks is scheduled for October 16th.Overall, the email highlights the discovery of a practical attack on lightning channels and the steps taken to mitigate its impact. It also raises awareness of potential risks to other bitcoin applications and encourages further investigation and protection against these attacks. The sender invites technical peers and the bitcoin community to examine the matter and welcomes dissenting opinions. The email concludes with a quote from Kipling's poem, emphasizing the need for vigilance and unbiased evaluation.</summary>
    <published>2023-10-16T16:57:36+00:00</published>
  </entry>
</feed>
