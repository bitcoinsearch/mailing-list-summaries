<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
  <updated>2023-10-25T17:04:13.812619+00:00</updated>
  <author>
    <name>Antoine Riard 2023-10-17 17:47:14+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
    <updated>2023-10-25T17:04:13.812619+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-October/022011.html" rel="alternate"/>
    <summary>The email discusses the possibility of a potential attack on Lightning Network (LN) channels with high capacity and loose channel policies. The sender clarifies that no such attack has been observed on the mainnet and states that they have conducted a demo attack in restricted dev circles to experiment with different scenarios.

The risk of exposure exists if an attacker targets channels with high capacity and loose channel policies. The email mentions that there is no way to configure the cap for the total value of outbound HTLC (Hash Time Lock Contract) in-flight, which is the flow affected by the attack. To observe the existence of such an attack, one can look at mempool logs and the amount of HTLC output being systematically conflicted out with a specific sequence.

The email notes that this attack is not akin to a pinning attack, as there is no "honest" or "malicious" transaction pinned in network mempools. It can happen without network mempool congestion. The attack involves controlling two neighboring nodes to target a victim and cycling the attack on the tail side while delaying the confirmation of the HTLC-timeout covenant on the front side of the victim's channel.

The sender suggests testing this behavior and mentions that Eclair and LND have implemented Local-mempool preimage monitoring as a mitigation against old school pinning attacks and replacement cycling attacks, respectively. However, Core-Lightning and LDK have not implemented this mechanism.

The email proposes a defensive fee mitigation strategy where the attacker aggressively fee-bumps their HTLC-output and adds fees to the htlc-covenant in anchor channels. This makes the attack more costly for the peer when they know that the attacker uses fees up to 50% of the HTLC value. The email mentions that repeating this cycle 144 times would result in a heavy loss for the attacker.

Lastly, the email highlights the lack of a way at the spec-level to negotiate a cap on the total value of outbound HTLC in-flight, which can lead to losses for the attacker when they try to steal small HTLCs.

Overall, the email discusses the potential risks and strategies related to attacks on LN channels with high capacity and loose channel policies. It emphasizes the need for monitoring and mitigation measures to safeguard against such attacks.</summary>
    <published>2023-10-17T17:47:14+00:00</published>
  </entry>
</feed>
