<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
  <updated>2023-10-21T01:52:20.415916+00:00</updated>
  <author>
    <name>Antoine Riard 2023-10-19 19:33:22+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
    <updated>2023-10-21T01:52:20.415944+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-October/022029.html" rel="alternate"/>
    <summary>In the email, Antoine discusses a scenario involving a replacement-cycling attacker and a defender with a scorched earth policy. The attacker can afford to pay 100% of the HTLC (Hashed Timelock Contract) value under this policy and still gain economically. The example includes three routing hops, Alice, Bob, and Caroll, all targeted by the attacker.The attack begins with Alice broadcasting her HTLC-timeout at T + 1 with a committed fee of 10,000 sats (satoshi). Mallory, the attacker, then replaces it at T+2 with an HTLC-preimage X of 200,000 sats (+ rbf penalty 1 sat/vb rule 4). Here, "rbf" stands for Replace-by-Fee. Alice's HTLC-timeout is out of network mempools.Next, Bob broadcasts her HTLC-timeout of 200,000 sats at T+3, which is replaced by Mallory at T+4 with her HTLC-preimage Y of 200,000 sats (+ rbf penalty 1 sat/vb rule 4 * 2). Again, Bob's HTLC-timeout is out of network mempools. HTLC-preimage Y conflicts with HTLC-preimage X as well.Lastly, Caroll broadcasts her HTLC-timeout of 200,000 sats at T+5, which is replaced by Mallory at T+6 with her HTLC-preimage Z of 200,000 sats (+ rbf penalty 1 sat/vb rule 4 * 3). Caroll's HTLC-timeout is also out of network mempools. HTLC-preimage Z conflicts with HTLC-preimage Z too. At any time, if Mallory's HTLC-preimage enters the top mempool feerates group due to accumulated rbf penalty, one unconfirmed ancestor can be double-spent to evict the HTLC-preimage. If Mallory successfully performs replacement cycling, she may incur a loss of 10,000 sats + rbf penalty cost for each rebroadcast attempt of the victim. However, she would gain the HTLC value of 200,000 sats from each of Alice, Bob, and Caroll.Assuming 5 rebroadcasts per block (even on random timers), multiplied by 3 victims, 200 bytes of HTLC-preimage, and cltv_delta of 144 blocks, the total attacker cost is 432,000 sats. The economic gain realized by the attacker is 168,000 sats. It seems that each additional victim has a cost of 144,000 sats, regardless of the targeted HTLC value.Antoine expresses gratitude for checking the fees math and replacement rules, noting that they appear correct. He also mentions that his analysis does not introduce more favorable assumptions for the attacker, such as mempool spikes where the "honest" HTLC-timeout transactions can be left floating in network mempools.Overall, this scenario highlights the potential vulnerabilities and economic considerations in the context of HTLC replacement cycling attacks.</summary>
    <published>2023-10-19T19:33:22+00:00</published>
  </entry>
</feed>
