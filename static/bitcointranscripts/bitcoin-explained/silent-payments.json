{
    "id": "bitcointranscripts+bitcoin-explained+silent-payments",
    "title": "Silent Payments",
    "body_formatted": "{\"type\":\"paragraph\",\"text\":\"Aaron: 00:00:20\"}, {\"type\":\"paragraph\",\"text\":\"Live from Utrecht, this is Bitcoin Explained.\\nHey, Sjors.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:00:23\"}, {\"type\":\"paragraph\",\"text\":\"Yo. \"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:00:25\"}, {\"type\":\"paragraph\",\"text\":\"Hey, Ruben.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:00:26\"}, {\"type\":\"paragraph\",\"text\":\"Hey.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:00:27\"}, {\"type\":\"paragraph\",\"text\":\"Ruben is back.\\nI think last time In Prague, we were all in Prague last week and there I introduced you as our resident funky second layer expert.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:00:38\"}, {\"type\":\"paragraph\",\"text\":\"That is right.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:00:39\"}, {\"type\":\"paragraph\",\"text\":\"This week we're going to talk about one of your new proposals, which is actually not a second layer proposal.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:00:45\"}, {\"type\":\"paragraph\",\"text\":\"True.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:00:46\"}, {\"type\":\"paragraph\",\"text\":\"You've promoted to the base chain.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:00:49\"}, {\"type\":\"paragraph\",\"text\":\"I guess so.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:00:46\"}, {\"type\":\"paragraph\",\"text\":\"Congratulations.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:00:50\"}, {\"type\":\"paragraph\",\"text\":\"Thank you.\\nWelcome to the base chain.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:00:53\"}, {\"type\":\"paragraph\",\"text\":\"It's good to be here.\\nThank you.\"}, {\"type\":\"heading\",\"text\":\"Introduction to Silent Payments\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:00:55\"}, {\"type\":\"paragraph\",\"text\":\"So, we're going to discuss silent payments.\\nThis is a proposal you made recently, right?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:01:01\"}, {\"type\":\"paragraph\",\"text\":\"It's a recent proposal.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:01:04\"}, {\"type\":\"paragraph\",\"text\":\"So you proposed this a couple of months ago, but I think the general idea is also older, right?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:01:09\"}, {\"type\":\"paragraph\",\"text\":\"Very old.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:01:10\"}, {\"type\":\"paragraph\",\"text\":\"It's based on an old idea called Stealth Addresses, I think, originally proposed by Peter Todd years ago.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:01:16\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, 2014.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:01:16\"}, {\"type\":\"paragraph\",\"text\":\"And this is an improvement on that, an iteration on that?\\nHow would you describe that?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:01:22\"}, {\"type\":\"paragraph\",\"text\":\"You could say that.\\nSo yeah, the interesting thing is that the original proposal, I think the idea is kind of old, but the downside of this version is that you have to do a lot of work essentially to recognize that you got paid.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:01:36\"}, {\"type\":\"paragraph\",\"text\":\"Of your version.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:01:37\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\\nAnd I think in the past, it's not like people didn't think of that, but at the time it seemed like that was going to be too much work.\\nAnd Bitcoin has improved a lot over the years.\\nSo actually, I think sort of like that, that thinking never got updated.\\nAnd now we're at the point where we can do these kind of the verification of the blockchain quite quickly.\\nAnd the library that we use, `libsecp256k1`, is very fast now.\\nSo basically, it made it more viable than it was back in 2014.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:02:15\"}, {\"type\":\"paragraph\",\"text\":\"And for the loyal listeners, we did an episode about `libsecp256k1`.\\nI think it's episode two.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:02:24\"}, {\"type\":\"paragraph\",\"text\":\"Really?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:02:25\"}, {\"type\":\"paragraph\",\"text\":\"Oh, wow.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:02:26\"}, {\"type\":\"paragraph\",\"text\":\"That's Sjors for you.\\nYou'll remember everything.\\nYou'll remember me.\\nOkay, So we can maybe get into the comparisons later, but for now, what is the general idea?\\nWhat's the general problem that we're solving?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:02:38\"}, {\"type\":\"paragraph\",\"text\":\"So kind of a good way of putting it is that generally speaking, when you wanna make a payment, you have two options.\\nSomeone can give an address and you can reuse that address and continually pay that person on the same address.\\nAnd if you do that, then you lose all privacy because every time you receive a payment, I know it's your address and then maybe, you know, Sjors sent some money to you and I can see how many Bitcoins you have, etcetera, etcetera.\\nSo because that's a problem, generally what we do is let's say, Aaron, if I want to send you a payment, I tell you, I say like, Hey Aaron, I want to send you some Bitcoin.\\nCould you please give me an address?\\nAnd you're sure here's an address and every time I want to pay you, you have to give me that address.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:03:18\"}, {\"type\":\"paragraph\",\"text\":\"Well, I'll generate a new address every time, right?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:03:20\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, generate a new one.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:03:21\"}, {\"type\":\"paragraph\",\"text\":\"Ideally.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:03:22\"}, {\"type\":\"paragraph\",\"text\":\"Fresh one.\\nAnd so this proposal, silent payments, allows you to basically have a single static address and allow me to derive an address from that, that nobody can recognize except for you and me.\\nAnd so this makes it basically, it makes it the same process, but now it's non-interactive where I don't have to ask you for an address.\\nAnd that is particularly useful when you think of things like donations, where there's a cause.\\nThe cause posts one single address, and everybody goes and donates to that cause, and no interaction is required.\\nSo that is basically the proposal.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:04:00\"}, {\"type\":\"paragraph\",\"text\":\"So if I want to accept donations, then I'll post this, it's a stealth address, but you're not calling it a stealth address.\\nYou're calling it a silent payment address, right?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:04:10\"}, {\"type\":\"paragraph\",\"text\":\"Yes, just to differentiate, but it is essentially a form of stealth address.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:04:14\"}, {\"type\":\"paragraph\",\"text\":\"So I'm posting this quote unquote address on my website.\\nAnd then you, Ruben, in this case, can generate new addresses from this and send money there and then somehow I should be able to spend from this address.\\nThat's kind of where the trick comes in.\\nLike how can I spend money from addresses that you generated?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:04:33\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\"}, {\"type\":\"heading\",\"text\":\"Technical Deep Dive\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:04:34\"}, {\"type\":\"paragraph\",\"text\":\"Okay.\\nRuben, how can I spend money from addresses that you generated?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:04:40\"}, {\"type\":\"paragraph\",\"text\":\"Sure.\\nSo essentially what we do is we generate a shared secret and generating a shared secret is done by taking two public keys.\\nYou have a public key, I have a public key, and because we both know one private key, you know your private key, I know my private key, we can do this calculation, which is basically a multiplication, that allows us to generate a number that you know and I know, but nobody else knows.\\nAnd with this number, we can then generate a key that is sort of shared between us.\\nSo it's a public key.\\nYou could send money to that key, but if I were to send money to that key, both you and I could spend it, so that's not quite good enough.\\nSo we add one more step after we have the shared secret, which we turn into a shared key, we then add your public key to it.\\nSo now it's a combination of the shared key plus your key.\\nAnd that combination is something that only you know, because I don't know your public key.\\nI don't know the private key behind your public key.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:05:41\"}, {\"type\":\"paragraph\",\"text\":\"Okay, that's a lot of information in one go.\\nSo let's break it down.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:05:46\"}, {\"type\":\"paragraph\",\"text\":\"So what we did was a Diffie-Hellman exchange plus something else.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:05:49\"}, {\"type\":\"paragraph\",\"text\":\"Right, exactly.\\nSo, Sjors.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:05:53\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:05:53\"}, {\"type\":\"paragraph\",\"text\":\"What is a Diffie-Hellman exchange?\\nMaybe we let, that's the first part we can break down here, I think.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:05:58\"}, {\"type\":\"paragraph\",\"text\":\"So Diffie-Hellman was a famous rapper.\\nNo, basically the idea you're taking, it's being used in browsers too, for example, right?\\nSo when you connect to a website that's secure, they have a public key.\\nThe website essentially has a public key and you on your computer generate another public key and you basically tell the web server hey here's my public key and then the web server can send you information in secret and you can send the the web server information to that secret.\\nAnd so this really uses a very nice mathematical property, which is that if you take a private key A and you multiply it by a public key B, that is the same as when you take public key A times private key B.\\nSo that means that, well, with Bitcoin we have addresses which is essentially just a combination of a private key and a public key.\\nSo if I know my private key, obviously, and you know my public key and vice versa, then we can create a shared, essentially a shared address, a shared Bitcoin address where we both would own the shared Bitcoin private key and we both would own the Bitcoin shared public key.\\nBut this would be utterly useless because if either of us sends money to that, then either of us can steal that money.\\nWe don't want that.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:07:22\"}, {\"type\":\"paragraph\",\"text\":\"Okay.\\nI'm following you, but that's also because before we started recording, I had an hour to try to understand this.\\nSo to summarize this real briefly, the Diffie-Hellman exchange, two people have a public and a private key and then multiplying one public key with the other private key gets a secret number.\\nBecause both persons know their own private key and the other person's public key, they can both generate this number, but no one else can generate this number because no one has either, no one else has either private key.\\nOkay.\\nSo from this secret number, you could potentially create a Bitcoin private key.\\nYou could say that's a Bitcoin private key, essentially, and have a public key.\\nAnd then basically what you were just saying, Sjors, is you could use that, like if Ruben wants to send me money, he could use that.\\nWell, he couldn't, but he could send me money to that Bitcoin public key.\\nAnd now we both have the private keys.\\nSo the problem is then Ruben can just take the money back.\\nSo yeah, I would have been paid, but I wouldn't because Ruben can claim the money.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:08:34\"}, {\"type\":\"paragraph\",\"text\":\"It could be a feature.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:08:36\"}, {\"type\":\"paragraph\",\"text\":\"So we need to add one more level.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:08:39\"}, {\"type\":\"paragraph\",\"text\":\"It's a reversible payment.\\nMaybe exchanges would like this, right?\\nThey send money and they can take it back.\\nJust kidding.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:08:44\"}, {\"type\":\"paragraph\",\"text\":\"Or you make it a two step process, right?\\nWhere you receive the money on this common address and then the other side sweeps it away and wants to sweep this confirmed, but that would mean two transactions for one, but we really don't need to do that.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:08:56\"}, {\"type\":\"paragraph\",\"text\":\"So I'm not sure if I just made it more confusing for the listener.\\nThis is the way I understood it.\\nSo maybe that helps.\\nSo like you could now generate a Bitcoin private key and a public key.\\nHowever, if you send money to that, that's not secure because you can claim the money back.\\nSo there's one extra step that needs to be taken here.\\nWhat's that extra step, Ruben?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:09:15\"}, {\"type\":\"paragraph\",\"text\":\"So the extra step is that we take that shared secret, that shared key, and we add the public key of the recipients to that shared key.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:09:25\"}, {\"type\":\"paragraph\",\"text\":\"Right, so this is the same public key that I was sharing publicly, the silent payment thing that I had as a donation address.\\nAnd we now add the shared...\\nNo, you finish this sentence for me before I say it wrong.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:09:41\"}, {\"type\":\"paragraph\",\"text\":\"You add the shared key to it.\\nWhich is a derivative of the shared secret.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:09:45\"}, {\"type\":\"paragraph\",\"text\":\"And in this case, when you say adding it to it, it's basic, it's kind of like creating a two out of two multi-sig, except we use cryptographic tricks.\\nIt's not actually a two of two, it looks like a wonky out of wonky, but it's sort of, it is kind of like a two of two, right?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:10:04\"}, {\"type\":\"paragraph\",\"text\":\"You could think of it in that way, but essentially it is, basically we're using the fact that you can use elliptic curve cryptography in a way that is basically like regular math, where you can take someone's key and you can take someone else's key and you add them together.\\nAnd if you do this with the public keys, the private key is also the addition of one private key with the other private key.\\nSo we have two private keys essentially.\\nAnd by adding those two together, we generate a key that only you know, because I know one of the private keys if I were to send a payment to you, but I don't know the other one because it's your key.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:10:42\"}, {\"type\":\"paragraph\",\"text\":\"So the two private keys that we're adding together, to be very clear, are the shared secret private key that you were able to generate in combination with my public key, and then my actual private key that corresponds to the public key that I posted.\\nSo that's the two that we're adding together to create a new private key and a new public key.\\nWell, I'm the only one who can create a new private key because I'm the only one who has the private key that corresponds with my public.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:11:11\"}, {\"type\":\"paragraph\",\"text\":\"Maybe I can illustrate it from the other side, which is that if you just published your stealth address and we don't use it as a silent payment address, if you just publish an address, then anybody can send to it, right?\\nIt would just be a regular transaction where you only have the private key and I have the public key.\\nThe downside of that is that everybody can see what's going on.\\nSo what if you just add something to this regular address?\\nSo you're adding a shared key to the regular address, essentially.\\nThat might even be an easier way to understand it.\\nSo we just explain how you make the shared key.\\nAnd then we say we take a regular address or a regular private key.\\nWe just add a shared key to it so that nobody else in the world can see what's going on.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:11:50\"}, {\"type\":\"paragraph\",\"text\":\"Okay.\\nSo you, Ruben, you were going to send money to my donation address.\\nNow we've tried to explain how that works.\\nWe've explained how that works.\\nI hope people have been able to follow that.\\nSo you're sending money to that address.\\nNow the question is, how do I know that you did that and how do I actually generate the private key that corresponds to that?\\nBecause I need to know about it, right?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:12:17\"}, {\"type\":\"paragraph\",\"text\":\"So the first thing you need is you need to know the key that I used in order to generate the share secrets.\\nBecause you know your key, obviously, and I know your key because it was publicly online on your Twitter profile or whatever.\\nAnd so the key that I use is one of the keys of the inputs in the transaction that I create.\\nSo if I want to send a payment to you, I create a transaction, the transaction has inputs, the inputs have a public key corresponding to them, and I know the private key of those keys.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:12:47\"}, {\"type\":\"paragraph\",\"text\":\"This is just a Bitcoin private key, public key, just a public key that you were using anyways, that has your money on it, right?\\nYes.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:12:57\"}, {\"type\":\"paragraph\",\"text\":\"So when I create that transaction, I pick my input.\\nAnd that is the key that I use to generate the new address that only you can spend.\\nAnd that is where I sent the money.\\nAnd so the second step, so this is how I make the payment.\\nBut the second step is for you to recognize that I actually did that.\\nAnd that is sort of the tricky part and sort of the downside, I would say, of this proposal, which is that in order for you to recognize that I made a payment, you have to go and check every transaction that appears on the Bitcoin blockchain.\\nAnd you have to go and see if it is a payment to you.\\nAnd the way you do that is basically the same way we generated this address.\\nYou're also going to generate the address and you're going to see, so you're going to take the inputs, you're going to generate the shared secrets, add it to your own key, see if the result is one of the outputs.\\nAnd that is how you recognize whether or not you got paid.\\nSo it's a lot of effort, but the effort is all on the recipient side.\\nAnd if you're running a full node already, it's relatively not a lot more effort.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:13:58\"}, {\"type\":\"paragraph\",\"text\":\"So basically, every input of every transaction on the blockchain could be, as a recipient, could be for you.\\nSo that means you have to inspect every single transaction that's on the blockchain and for every input of every transaction you want to add your shared key to it and then that generates an address and you then see hey is this transaction actually spending to that address?\\nIf so, boom, you just essentially add that address to your own wallet, and then it just functions as any other wallet address would function.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:14:31\"}, {\"type\":\"paragraph\",\"text\":\"Well, I guess it's already the case that you need to check every transaction to see if there's an output for you, right?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:14:38\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:14:39\"}, {\"type\":\"paragraph\",\"text\":\"So the new part is that you have to do some extra calculations to see if the inputs and then-\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:14:47\"}, {\"type\":\"paragraph\",\"text\":\"But it's definitely a lot of extra work, right?\\nSo normally what you do is when you see a transaction, you only care about the outputs.\\nI mean, you care whether the transaction is valid at all.\\nThat's why you look at the inputs.\\nBut the outputs, the only thing your wallet needs to do is look at the `scriptPubKey` of this output, so basically the destination of the output, and then compare it to the list of addresses or ``scriptPubKey`` in your own wallet.\\nSo that is just comparing one list to another list.\\nThat's very cheap, but in this new scheme, you need to do basically elliptic curve key multiplication on every input, and then that gives you an address.\\nSo it is significantly more work than just looking at a list.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:15:28\"}, {\"type\":\"paragraph\",\"text\":\"To give a sort of approximate idea of how much work that is.\\nIt is as if you check every signature twice instead of once.\\nThat is sort of a very rough way of saying it.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:15:43\"}, {\"type\":\"paragraph\",\"text\":\"So it definitely increases the time you need to verify blocks.\\nIf you look at that from the perspective of your node is running you know, it's already synced and it's just running then one block comes in every 10 minutes your node will verify that block in a few seconds.\\nSo maybe it'll take half a second longer.\\nThat's fine, the bigger barrier is when you first want to sync the whole node.\\nIf you want to restore from a backup, things get a little bit more hairy.\\nBut I think we can get into that later.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:17:09\"}, {\"type\":\"paragraph\",\"text\":\"That is something actually I would like to get into now perhaps because so there are-\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:17:12\"}, {\"type\":\"paragraph\",\"text\":\"Ruben is taking charge.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:17:16\"}, {\"type\":\"paragraph\",\"text\":\"Well, I think if we do it later, it's going to be more confusing.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:17:19\"}, {\"type\":\"paragraph\",\"text\":\"Go for it.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:17:19\"}, {\"type\":\"paragraph\",\"text\":\"It's called Bitcoin Explained, now!\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:17:21\"}, {\"type\":\"paragraph\",\"text\":\"Exactly.\\nSo there are a couple of things you can do to make this process faster.\\nAnd so as Sjors was saying, once you're at the tip and you're validating, a new block comes in, you just have to validate everything.\\nBut one of the things you can do is, there are a couple of things you can do to sort of speed it up when you re-sync a node, and you have an address, and you want to know if there's any outputs that are yours.\\nSo the first thing you can do is simply have a birthday on your key and say, okay, well, I created this key in January 2022.\\nSo from January 2022, I go and I check every block.\\nAnd before that, I don't even bother.\\nSo that's one thing you can do.\\nAnother thing is that this protocol in principle is going to only create taproot outputs.\\nSo any transaction that doesn't have any taproot outputs in them can be ignored.\\nAnd so you don't have to check those transactions.\\nThat is sort of a thing that saves a lot of effort right now, because we don't have a lot of taproot transactions yet.\\nBut in time, eventually, everything's going to be a taproot transaction.\\nAt least that's the hope.\\nSo it's the kind of, it's an optimization that helps today, but won't help tomorrow, let's say.\\nAnd then the biggest one is that instead of validating every transaction from the entire history, what you can actually do is you can take the UTXO sets and only check those outputs and see if any of those outputs correspond to a payment that belongs to you.\\nAnd the downside of this is that you will have no history, so you won't be able to see any outputs that were yours and were spent, but you will find all the outputs that were unspent.\\nAnd it also requires a bit more of an additional database that ties the inputs that you might require to do this calculation to the UTXO and UTXO sets.\\nThere's a bit more complexity there, but the benefit there is that basically instead of scanning the entire history, you can now just take the UTXO sets, scan that, and find every unspent output that belongs to you.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:19:36\"}, {\"type\":\"paragraph\",\"text\":\"And then you'd need to somehow get the inputs that refers to the output.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:18:44\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:19:46\"}, {\"type\":\"paragraph\",\"text\":\"So when you look at how a node is actually built, and you know, Bitcoin Core is built in one way, but maybe Libbitcoin is built in a very different way, there are certain pieces of information that are very easy to access and certain pieces of information that are a little bit more work to access, and that can really matter with a proposal like this.\\nBecause if the information, for example, is sitting in your RAM memory, that's very quick to access.\\nIf on the other hand, you need to go on a disk, it's very slow to access.\\nAnd you may have a pruned node, where a pruned node throws away all blocks so if you need any information that is in an old block then things get really really really slow because either you just can't get the information or you'd have to download the block again and then get it.\\nSo those details matter and one of the things that I think needs to be done, and you're working on it, or you're having other people work on it, or you're hoping other people work on it, is benchmarking.\\nAnd this benchmarking basically could do things like, okay, we could change the proposal and do a little bit more signature verifications, or we could change the proposal in some other way, which means we need to do more disk reading.\\nAnd now let's try on the Raspberry Pi with the real blockchain, what performs better, what performs worse, that sort of stuff.\"}, {\"type\":\"heading\",\"text\":\"Comparison with earlier proposals\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:20:59\"}, {\"type\":\"paragraph\",\"text\":\"Is this a good time to get into the comparison with the earlier proposals?\\nOkay.\\nSo how does this compare to earlier proposals?\"}, {\"type\":\"heading\",\"text\":\"Original stealth address proposal\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:21:11\"}, {\"type\":\"paragraph\",\"text\":\"Sure.\\nSo the original stealth address proposal by Peter Todd, that one basically is quite similar, but the thing that was different is that because the scanning requirement was seen as something that was too much effort.\\nSo instead of taking the key from the input, the idea was that when you generate a payment, you add an `OP_RETURN` to it.\\nAnd in the `OP_RETURN`, you add a key.\\nAnd then that is the key that is being used.\\nAnd the downside of this-\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:21:45\"}, {\"type\":\"paragraph\",\"text\":\"So in that case, the sender's key, in your proposal, the sender's key is actually just the Bitcoin key, the one you're using to send money from.\\nIn this earlier proposal by Peter Todd, there's sort of a special key that's not the same key as the one that you used to spend money from, right?\\nAnd that's included in an `OP_RETURN`, a bit of extra data in the transaction.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:22:10\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, and so when you do that, obviously you add more overhead because now you have an `OP_RETURN`.\\nAnd the upside from the recipient side, well, it's sort of a half upside because one of the upsides is you still have to scan every transaction, but now you only have to scan every transaction with an `OP_RETURN` attached to it.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:22:30\"}, {\"type\":\"paragraph\",\"text\":\"And you only have to look at that `OP_RETURN`.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:22:31\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:22:32\"}, {\"type\":\"paragraph\",\"text\":\"It's a lot less math than you need to do in your proposal.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:22:36\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, and the database lookups and stuff are easier too, because you don't have to go back and find the inputs.\\nIt's right there in one of the outputs.\\nSo it's sort of an in-between solution that never really got popular.\\nAnd I think even the BIP itself was never finished.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:22:55\"}, {\"type\":\"paragraph\",\"text\":\"I guess one of the downsides is it makes transactions bigger because now you've got to include an `OP_RETURN`.\\nSo, you know, box fill up faster if a lot of people do that and fees go up.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:23:06\"}, {\"type\":\"paragraph\",\"text\":\"There's also a privacy downside.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:23:08\"}, {\"type\":\"paragraph\",\"text\":\"It's sort of an indicator that it might be a stealth payment, right?\\nEven though you're not sure, but if it's an indecipherable `OP_RETURN`, then that seems kind of likely.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:23:18\"}, {\"type\":\"paragraph\",\"text\":\"Well, it also means that other people looking at the blockchain can see how many \\\"friends\\\" you have.\\nSo because the number of `OP_RETURN`s to your stealth address that's publicly known, people can discount them.\\nOr is it not?\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:23:32\"}, {\"type\":\"paragraph\",\"text\":\"That's not probably-\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:23:32\"}, {\"type\":\"paragraph\",\"text\":\"That's only a BIP-47 then.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:23:34\"}, {\"type\":\"paragraph\",\"text\":\"You're confusing it too now.\\nNo, no, so that's not quite true.\\nIt is sort of a general, you see a bunch of transactions with `OP_RETURN`s and those are all stealth payments, but you don't know who those payments are going to.\\nAnd the recipients have to check all those specific addresses.\\nSo it's sort of an in-between solution where you could say like, it's sort of like my proposal, but instead there's a tag that says, okay, this is a stealth payment.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:24:00\"}, {\"type\":\"paragraph\",\"text\":\"And this might be a stealth payment.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:24:03\"}, {\"type\":\"paragraph\",\"text\":\"Well, I think it's quite obvious, unfortunately.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:24:06\\nOk, so the `OP_RETURN` is only indicating that it's a stealth payment.\\nAnd then after the `OP_RETURN` is the shared key.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:24:12\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:24:12\"}, {\"type\":\"paragraph\",\"text\":\"So, in that case, you could probably do that with just combining signatures, and then you're pretty much back to your proposal, right?\\nInstead of using `OP_RETURN`, you would just basically use some sort of added key or tweak key, and you just have to check every key.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:24:31\"}, {\"type\":\"paragraph\",\"text\":\"So there's a lot of similarity.\\nAnd I think the stealth address proposal also had the suggestion of adding sort of yet another identifier of saying like, okay, well, instead of checking every `OP_RETURN`, we mark it where, let's say, you pick a number between, let's say, zero and 64 or something.\\nAnd so my stealth payment is let's say 64 exactly.\\nSo whenever in the `OP_RETURN` it says number 64 and then there's a public key, I only check those.\\nSo it reduces the anonymity set even further, but it also lowers the scanning requirements.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:25:06\"}, {\"type\":\"paragraph\",\"text\":\"Exactly.\\nYour proposal is a lot of work, but a stealth transaction will look exactly the same as any other transaction.\"}, {\"type\":\"heading\",\"text\":\"BIP47\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:25:13\"}, {\"type\":\"paragraph\",\"text\":\"Okay.\\nAnd then there's,\\nWhat is it?\\nBIP47?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:25:17\"}, {\"type\":\"paragraph\",\"text\":\"That is correct.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:25:18\"}, {\"type\":\"paragraph\",\"text\":\"And that uses the concept of a handshake, I would say.\\nSo you publish your stealth address or whatever it is.\\nI think they use a PayNym as a term for some people.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:25:27\"}, {\"type\":\"paragraph\",\"text\":\"That is a term that Samurai Wallet uses, and I think Sparrow wallet has it implemented as well, but that's just the implementation.\\nIn principle, it's BIP47.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:25:36\"}, {\"type\":\"paragraph\",\"text\":\"So you publish this, essentially, public key, and then when you want to send somebody money using that, you do an announcement transaction first.\\nI think you send a `OP_RETURN` payment to that address or something like that.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:25:54\"}, {\"type\":\"paragraph\",\"text\":\"That's correct.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:25:54\"}, {\"type\":\"paragraph\",\"text\":\"And that `OP_RETURN` then includes some sort of key that the recipient now knows, okay, I now have a new friend and I need to start monitoring the following addresses.\\nSo in this case, from one single transaction, you as the recipient can now generate a whole set of addresses that you just monitor as if you got an xPub.\\nAnd so that's nice.\\nThe downside is in this case of what I said before, incorrectly for the other one, is now everybody can see how many friends you have.\\nBecause at this handshake address is going to be a bunch of `OP_RETURN` transactions to that address so you can count, you know, a maximum of the number of friends you have.\\nI guess somebody could pretend that there are like five people.\\nAnd it adds a little bit of bloat to the blockchain.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:26:39\"}, {\"type\":\"paragraph\",\"text\":\"So that seems to be the biggest trade-off.\\nIs that right?\\nSo your proposal, Ruben, doesn't add any extra data to the blockchain.\\nAnd then the trade-off is that the recipient has to do quite a bit of work because it has to check all the transactions.\\nWhile the other proposals in their own ways, they add more data to the blockchain, but then it is easier after you've done that.\\nAnd then there's more nuances, but is this-\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:27:04\"}, {\"type\":\"paragraph\",\"text\":\"Well, with the stealth addresses, there's still a lot of work to do.\\nSo I think the stealth addresses are sort of just old and outdated, and I think you can just sort of leave those aside.\\nBut for BIP47 specifically, yes, there is not the scanning requirements.\\nSo what you said is correct for BIP47, but to add a little bit to the downsides.\\nWhen you create this notification transaction, you're also spending one of your outputs to create that notification.\\nAnd then those outputs that you're using can then not be used for regular payments if you want to stay anonymous.\\nSo it's sort of like you have to sort of, the money that you use to create the notifications need to be kept completely separate from the money that you use to pay people.\\nAnd that is in general very difficult for wallets to implement.\\nAnd a lot of wallets haven't implemented this correctly.\\nAnd so there's a lot of potential there for sort of privacy leaking, unfortunately.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:27:59\"}, {\"type\":\"paragraph\",\"text\":\"So You think you have a stealth address, you think you're sending anonymously, but actually because of that announcement, somebody else can just still see exactly, both from the sender side, they can just see that the sender was doing this, but also it means the recipient loses anonymity because if the sender screw up, you can tell the recipient received this many coins because of this correlation.\\nSo that's a risk.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:28:21\"}, {\"type\":\"paragraph\",\"text\":\"But one thing that's maybe interesting to note is that in Prague, I had a discussion with a couple of other developers, namely Martin and Alekos.\\nAnd we have sort of thought of an idea to sort of make BIP47 better and make it so that the notification transaction can be outsourced to someone else.\\nSo there's maybe a way to sort of mitigate that for BIP47.\\nAnd then the only downside that you are left with is the fact that it uses additional on-chain space.\\nAnd other than that, it sort of functions.\\nSo that would sort of make the comparison a little bit more favorable in terms of comparing silent payments with BIP-47.\\nBut still there is sort of this, this difference in on-chain space usage, which is particularly problematic for single payments.\\nWhen you want to send a one-time donation to someone, then, you know, that overhead of that notification is quite significant.\"}, {\"type\":\"heading\",\"text\":\"Other generic schemes\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:29:20\"}, {\"type\":\"paragraph\",\"text\":\"Might be useful also to compare to some other generic schemes to solve the same problem.\\nSo one is that instead of publishing...\\nWell, one is that it requires a little bit of interaction.\\nSomebody has to send you an email anonymously and you reply with an xPub and now they can just send whatever they want to that xPub.\\nThat's one thing you can do.\\nYou can run a little Tor hidden service that will just hand out xPubs to anybody who asks.\\nThat is a problem with, you know, denial of service and of course you have to run server.\\nDenial of service means basically somebody could ask you for an xPub and then ask you for an xPub and ask you for an xPub.\\nAnd then for every time you've given out an xPub, you've got to monitor like a thousand addresses forever.\\nSo that's one thing.\\nAnother obvious thing you can do is use Lightning because with Lightning, you have a public key and something like a Bolt 12 tattoo.\\nOnce that's finalized, we'll make it just very easy to receive money, but it means some...\\nThat puts a bit more burden on the sender, definitely not as much burden on the recipient, because what you're proposing doesn't sound more difficult than running a Lightning Node.\\nAt least not more resource intense than running a Lightning node.\\nBut for the sender, of course, they have to run a Lightning node.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:30:36\"}, {\"type\":\"paragraph\",\"text\":\"It's interactive, essentially, when you use Lightning.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:30:40\"}, {\"type\":\"paragraph\",\"text\":\"But Ruben just promoted to the base chain, so.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:30:43\"}, {\"type\":\"paragraph\",\"text\":\"Now we're moving back to the base..\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:30:47\"}, {\"type\":\"paragraph\",\"text\":\"Don't kick him back to Lightning.\\nLet him enjoy his stay here.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:30:51\"}, {\"type\":\"paragraph\",\"text\":\"And on the base chain, you can run a BTCPay Server or something like that that will give out a unique address every time.\\nThat's a little bit less of a DDoS problem than an xPubs.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:31:03\"}, {\"type\":\"paragraph\",\"text\":\"I mean, you still have to give out a new address, right, for BTCPay Server.\\nI still think it's a problem.\\nI wonder how they solved that problem, actually, because you have the same issue where if you continually ask for addresses.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:31:11\"}, {\"type\":\"paragraph\",\"text\":\"But an xPub represents a thousand addresses, so your problem is a thousand times bigger, but it's the same type of problem.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:31:18\"}, {\"type\":\"paragraph\",\"text\":\"True.\\nAnd so just to sort of generalize, I think the sort of the trade-offs that you're mentioning here is one of interactivity, where with silent payments, the nice thing is it is just entirely non-interactive.\\nBut you are absolutely correct that, you know, given sort of like the complexity of what you said, it is possible to solve this with interaction.\\nAnd that is essentially what we started off with, with me saying, okay, well, if Aaron just gives me a new address every time I want to send a payment to him, that works too.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:31:49\"}, {\"type\":\"paragraph\",\"text\":\"The whole point is to make this non-interactive.\"}, {\"type\":\"heading\",\"text\":\"Using DNS to announce your address\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:31:53\"}, {\"type\":\"paragraph\",\"text\":\"I wanted to mention one cool possibility that I saw somebody bring up on one of the threads that related to this, which is the idea of using DNS or the `/.well-known/` URL to announce your address.\\nSo what you can do is if you run a web server or React, you have a provider that does that for you, is you could say, well, If somebody types in my email address, then the wallet will just basically know where to look, either in the DNS record or at a specific spot on the web server, and it will get the key there.\\nSo then, if you have a very smart wallet, I could imagine that I just type somebody's email address and it'll see, oh, is there a silent payment ID there?\\nIs there a Bolt 12 invoice there?\\nIs there an LN URL thing there?\\nI'll just pick one of those three, and I'm going to send the money to it.\\nSo from a usage point of view, it's very nice to have these static identifiers.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:32:50\"}, {\"type\":\"paragraph\",\"text\":\"I see what you mean.\\nThat's interesting.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:32:53\"}, {\"type\":\"paragraph\",\"text\":\"And I also have a downside, but that might be solvable.\\nAnd that is what I would call the Hotel California problem.\\nBecause basically once you've given out this thing, people can keep paying to it forever.\\nAnd at some point you might realize, ah, this running this extra thing on my node is pretty heavy.\\nI'd like to downgrade.\\nI'd like to stop using this.\\nAnd I think that can be solved by just putting an expiration date into them.\\nLike saying like, okay, don't send coins to me after this block height.\\nThat would just be part of the standard.\\nAnd then you scan a few hundred thousand or you scan like 10,000 bucks extra, just to be sure.\\nBut you definitely want to make sure that people can opt out of this stuff.\\nBecause with Bolt 12, that's not a problem, right?\\nWith Lightning, you still have to ask an invoice.\\nAnd if the server doesn't respond, you don't send money to it.\\nBut with this, if somebody sends you money 50 years from now, like your descendants will have to like scan the whole blockchain.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:33:46\"}, {\"type\":\"paragraph\",\"text\":\"That is a good point.\\nAnd that's something I hadn't really thought about.\\nBut I agree that it would be nice to support maybe a date at which you stop, well, either you stop using the address or you have to refresh the address as to say like, okay, well now I'm going to accept it for longer.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:34:04\"}, {\"type\":\"paragraph\",\"text\":\"So that's when you combine it with this DNS server system, your wallet would just ask again and you could have very short expiration dates even on them.\\nThat's not necessarily the case, but you could use the same payment code again.\\nYou could just say like, okay, I'm only gonna guarantee this thing for like a week.\\nAnd then if you ask again next week, I'll say, okay, no, don't worry.\\nYou can use the same key.\\nIt's gonna be valid for another week.\\nSomething like that.\\nThat's, I mean, I have a whole bunch of like implementation stuff, but I don't think we have to get there.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:34:34\"}, {\"type\":\"paragraph\",\"text\":\"That's interesting though, but yeah.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:34:35\"}, {\"type\":\"paragraph\",\"text\":\"How long have we been recording, Sjors?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:34:37\"}, {\"type\":\"paragraph\",\"text\":\"33 minutes.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:34:38\"}, {\"type\":\"paragraph\",\"text\":\"How deep are we into this stuff?\\nBecause there's a lot more in the show notes, or at least there's some more in the show notes.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:34:44\"}, {\"type\":\"paragraph\",\"text\":\"Sure.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:34:44\"}, {\"type\":\"paragraph\",\"text\":\"Like, do we want to get into that?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:34:46\"}, {\"type\":\"paragraph\",\"text\":\"I've covered everything I wanted to cover, but...\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:34:48\"}, {\"type\":\"paragraph\",\"text\":\"I guess the one thing...\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:34:50\"}, {\"type\":\"paragraph\",\"text\":\"There's this...\\nGo on, Ruben.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:34:52\"}, {\"type\":\"paragraph\",\"text\":\"Just one thing I wanted to mention maybe is that I think what's good to point out here is that the scanning downside really is mainly a downside if you're not running a full node.\\nIf you're running a full node, the way I look at it is that we still have to get these benchmarks.\\nAnd so as Sjors already mentioned, there's a pseudonym called W0XLT, who I'm trying to collaborate with a little bit now in order to get these benchmarks.\\nAnd he's already created an implementation.\\nAnd once we have those, we can get a better idea.\\nBut my feeling is that we can get it down to a level where if you're running a full node and you're doing this additional computation to receive these silent payments, it is not a lot of extra overhead.\\nSo from that perspective, I think you could say that sort of the overhead is practically zero if you're already running a full node.\\nAnd then for light clients, the problem is that even though, like many of the light clients, most of the light clients we have today, they share an xPub with whatever server is running the light client for them.\\nAnd if you give out your xPub to a server, you lose all your privacy.\\nSo it's actually very difficult to have a ligth client and have privacy at the same time.\\nIt's not impossible.\\nWe have a BIP 157 and 158, that is a compact block filters.\\nSo you could have sort of a light client that preserves your privacy better.\\nBut as far as I know, it's maybe Wasabi wallets.\\nAnd I'm not even sure some lightning wallets maybe use it.\\nBut other than that, most wallets don't really do that today.\\nSo my argument there is sort of that if you care about privacy, you already sort of have to run a full node.\"}, {\"type\":\"heading\",\"text\":\"Implementation and Future Directions\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:36:39\"}, {\"type\":\"paragraph\",\"text\":\"And so you mentioned there's a pseudonym working on this.\\nSo how concrete is this?\\nAre we going to, when am I going to be able to use this?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:36:47\"}, {\"type\":\"paragraph\",\"text\":\"I did run the demo today on Signet.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:36:50\"}, {\"type\":\"paragraph\",\"text\":\"Cool, talk about it.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:36:50\"}, {\"type\":\"paragraph\",\"text\":\"So that was fun.\\nSo the pseudonym you talked about, let's call him Ox.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:36:56\"}, {\"type\":\"paragraph\",\"text\":\"Ox, yeah, it's easier.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:36:59\"}, {\"type\":\"paragraph\",\"text\":\"Created a pull request on Bitcoin Core that is like really marked as like this is just a proof of concept.\\nDon't merge this.\\nDon't even use this with real coins, right?\\nAnd it allows you to create a wallet that can receive silent payments and it allows you to use any wallet really to send silent payments.\\nAnd you know, it requires a little bit of manual stuff, but it worked.\\nI mean, at least it seemed to work.\\nI haven't checked if the math actually worked.\\nIf somebody steals my Signet coins, I don't care for real coins.\\nI want to be a little bit more sure that this is right.\\nI have some remarks in mind that I'll probably post before the show comes out.\\nBut I mean, if you look, I mean, there are different approaches to get a new proposal like this done, right?\\nAnd I would congratulate you.\\nI think this is the first time or the fastest ever that you've gone from like proposing something really complicated to something that actually demos the concept.\\nAnd I personally, I like running code to understand something better.\\nAnd so, and then when I looked at it, like this approach of changing Bitcoin Core to support it is one approach.\\nAnother approach could be something like what Specter Wallet does is you create a tool that people download or install that is separate from Bitcoin Core, but that uses Bitcoin Core wherever it's useful.\\nAnd so I looked at both possibilities and both are not trivial in this case.\\nFor details I don't think we necessarily have to go into, but this proposal, I don't think this pull request will ever, well, will not get merged in the short run, even if he improves everything.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:38:31\"}, {\"type\":\"paragraph\",\"text\":\"Not in Bitcoin Core.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:38:32\"}, {\"type\":\"paragraph\",\"text\":\"No, and a couple of reasons for that is because it essentially requires another index, which takes up space and it is, you know, like you said, it's maybe not the worst extra performance downside, but it's still pretty significant.\\nYou know, it still adds.\\nSo I think Bitcoin Core would not very quickly commit to a feature that it has to maintain forever that really eats a lot of resources and may screw with other proposals that might enhance scaling, like how does this combine with assumeUTXO or how does this combine with Utreexo or...\\nSo that's why I think it's better to go for a separate tool.\\nOn the other hand, any demo that works, I'm happy with it.\\nI don't really care how it's done, whether the demo is a modified version of Bitcoin Core or a little Python script.\\nI don't think it matters as long as people play with the demo because standards will get much better when people actually try them.\\nOtherwise you get things like BIP32 and like, oh, gap limits.\\nI guess we should have thought about that before we defined a standard.\\nSo yeah, I'm happy to see that.\\nI just would want to caution the listener and this is probably gonna take a while.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:39:43\"}, {\"type\":\"paragraph\",\"text\":\"I agree with that.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:39:45\"}, {\"type\":\"paragraph\",\"text\":\"Because I guess I should explain the other side of it.\\nIf you make a separate tool, now you're no longer a first class citizen of Bitcoin Core.\\nSo you have to communicate through Bitcoin Core, through the RPC, and it has very limited features, very limited things you can do.\\nAnd one of the things you may want to do is very tightly integrate with block validation.\\nSo when a block comes in, you want to do some processing specifically for the wallet.\\nYou can't do that right now with Bitcoin RPC.\\nSo yeah, it's tricky.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:40:11\"}, {\"type\":\"paragraph\",\"text\":\"There's some complexity there.\\nBut yeah, at a high level, I agree with you.\\nAnd so one of the things that's sort of tricky for me is that actually spacechains is sort of the project that I'm currently focused on.\\nAnd now this silent payment thing, it was supposed to be sort of a side project where I thought like, okay, I'm just going to put this out on a gist and then I'm done with it.\\nAnd then people start running with it and this Ox guy, he implements it.\\nAnd now I'm like, okay, shit, I got to put some effort into this as well now.\\nSo I'm being pulled into multiple directions, but it's a good thing because it's a success story, I guess.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:40:48\"}, {\"type\":\"paragraph\",\"text\":\"I mean, spacechains is literally a side project, right?\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:40:52\"}, {\"type\":\"paragraph\",\"text\":\"It's a sidechain project, yes.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:40:54\"}, {\"type\":\"paragraph\",\"text\":\"That's the pun of the week.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:40:55\"}, {\"type\":\"paragraph\",\"text\":\"Good joke, yes.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:40:56\"}, {\"type\":\"paragraph\",\"text\":\"All right, it's a good pun.\\nI have another pun on the GitHub comment, but it's not for here.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:41:03\"}, {\"type\":\"paragraph\",\"text\":\"All right, well, I'll look forward to hearing that offline.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:41:06\"}, {\"type\":\"paragraph\",\"text\":\"I cannot wait, Sjors, to read that.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:41:08\"}, {\"type\":\"paragraph\",\"text\":\"It's gonna be amazing.\\nOkay, I think that covers everything.\"}, {\"type\":\"heading\",\"text\":\"Coinjoins and Silent Payments\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:41:12\"}, {\"type\":\"paragraph\",\"text\":\"Is there anything, Aaron, I think there's something you wanted to bring up still, or am I mistaken here?\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:41:17\"}, {\"type\":\"paragraph\",\"text\":\"I mean, I was gonna ask about Coinjoin.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:41:22\"}, {\"type\":\"paragraph\",\"text\":\"Ah, yes, of course.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:41:23\"}, {\"type\":\"paragraph\",\"text\":\"That seems like opening up another can of worms.\\nI don't know if we wanna go there.\\nThat is true.\\nNow that I've brought it up, we can't really ignore it completely.\\nDo you want to summarize this in like a minute?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:41:36\"}, {\"type\":\"paragraph\",\"text\":\"I think we should briefly look at the worms.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:41:38\"}, {\"type\":\"paragraph\",\"text\":\"I agree.\\nNow that's actually a good one to point out.\\nSo I think this is one of these things that I feel most uncomfortable with in terms of, like, because ideally what you want to do is you want this protocol to not get in the way of how people do transactions.\\nAnd so far, the way we've described it, it sort of works really well if there is one sender, if I create the transaction.\\nBut what if we wanted to create a transaction as a Coinjoin where we have multiple people adding their inputs?\\nAnd so the first issue is that you sort of have two variants of...\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:42:14\"}, {\"type\":\"paragraph\",\"text\":\"And then one of the recipients is a stealth address.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:42:17\"}, {\"type\":\"paragraph\",\"text\":\"Exactly.\\nYes, yes.\\nThat's good to add.\\nThank you.\\nSo the first issue is sort of that you have two variants that you could do for a sign of payments.\\nWell, there are more variants, but these are the two sort of main ones, which is either you pick one input and you use that to generate the shared secret, or you pick the combination of all the inputs.\\nAnd this is particularly relevant with Coinjoins because if you pick just one input, then what that means is that if someone pays you in a CoinJoin, then the recipient normally doesn't know what your input was.\\nSo that's actually very good for privacy.\\nBut if you use the silent payments, now if it's just with a single input, you can see which input was paying you.\\nAnd so that leaks some privacy for the sender.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:43:03\"}, {\"type\":\"paragraph\",\"text\":\"You can see which input pays you because that's the one that adds up to your new address.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:43:08\"}, {\"type\":\"paragraph\",\"text\":\"Exactly.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:43:09\"}, {\"type\":\"paragraph\",\"text\":\"There's only one input that matches your new address.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:43:11\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\\nAnd so that's solvable by saying, okay, well, we pick all the inputs instead.\\nAnd we add those inputs together and we use that to generate the shared secret.\\nBut once you do that, you need the collaboration of all the Coinjoin participants.\\nAnd in fact, you need them to generate a shared secret.\\nAnd you also don't want them to know who you are paying.\\nSo you need to get them to give you their shared secret in a way that they don't know what they're giving to you.\\nAnd there's a protocol for that too, which is basically a blind way of doing a Diffie-Hellman, which is also used in e-cash.\\nLong story short, a lot of complexity.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:43:48\"}, {\"type\":\"paragraph\",\"text\":\"A lot of worms.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:43:49\"}, {\"type\":\"paragraph\",\"text\":\"And you're actually making the single, the simple case, you're making that more complicated by aggregating the signatures.\\nBecause normally when I use a wallet to make this silent payment, I just need to pick one coin, one input, and then if the wallet needs to, it can just add more inputs to that transaction and it will still work.\\nBut if you want to have all the inputs count towards the shared key, then I need to decide before I have the destination address, I need to decide which coins I'm going to use.\\nAnd so then you have the coin selection process separate from the payment process and that at least in Bitcoin Core, that's going to give you another can of worms that I recommend not opening.\\nThere are solutions to it.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:44:28\"}, {\"type\":\"paragraph\",\"text\":\"Well, the other thing that's sort of nice about adding all the input keys together and why I sort of gravitate towards that is that it essentially cuts down the scanning requirement in half, because now instead of having to scan every individual input, you can scan the aggregation of all the inputs.\\nAnd on average, a transaction has two inputs.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:44:46\"}, {\"type\":\"paragraph\",\"text\":\"That's true, but that's where the benchmarking has to come in, because I would not be surprised at all if the, whether you look at inputs individually or you add them up, most of the work is probably going to be in fetching the original transactions from some disk somewhere.\\nAnd then the actual elliptic curve math is gonna be much less than that because in general it takes a long time to read something from a disk it takes a very short time to do a calculation on the CPU but that could be completely wrong that's why you want to benchmark this stuff.\"}, {\"type\":\"paragraph\",\"text\":\"Ruben: 00:45:16\"}, {\"type\":\"paragraph\",\"text\":\"So I am sort of I have the same concern in terms of this needs to be benchmarked and we need to compare it all.\\nAnd quite frankly, I even think that maybe the UTXO set scanning is overkill too.\\nMaybe it's just better to just do the entire scanning when you do IBD and maybe that's sufficient.\\nSo it's sort of, yeah, it all comes down to the benchmarks basically.\\nI agree with that.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:45:40\"}, {\"type\":\"paragraph\",\"text\":\"Cool.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:45:41\"}, {\"type\":\"paragraph\",\"text\":\"Okay.\\nI think that's our episode.\\nSjors, what do you think?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors: 00:45:46\"}, {\"type\":\"paragraph\",\"text\":\"Sounds good.\\nI'm not going to put this thing as a tattoo on me yet.\\nBut I'm going to keep it in mind.\\nYep, I think that's it.\\nSo thank for listening to Bitcoin\"}, {\"type\":\"paragraph\",\"text\":\"Aaron: 00:45:58\"}, {\"type\":\"paragraph\",\"text\":\"Explained.\"}",
    "body": "Aaron: 00:00:20\n\nLive from Utrecht, this is Bitcoin Explained.\nHey, Sjors.\n\nSjors: 00:00:23\n\nYo. \n\nAaron: 00:00:25\n\nHey, Ruben.\n\nRuben: 00:00:26\n\nHey.\n\nAaron: 00:00:27\n\nRuben is back.\nI think last time In Prague, we were all in Prague last week and there I introduced you as our resident funky second layer expert.\n\nRuben: 00:00:38\n\nThat is right.\n\nAaron: 00:00:39\n\nThis week we're going to talk about one of your new proposals, which is actually not a second layer proposal.\n\nRuben: 00:00:45\n\nTrue.\n\nAaron: 00:00:46\n\nYou've promoted to the base chain.\n\nRuben: 00:00:49\n\nI guess so.\n\nAaron: 00:00:46\n\nCongratulations.\n\nSjors: 00:00:50\n\nThank you.\nWelcome to the base chain.\n\nRuben: 00:00:53\n\nIt's good to be here.\nThank you.\n\n## Introduction to Silent Payments\n\nAaron: 00:00:55\n\nSo, we're going to discuss silent payments.\nThis is a proposal you made recently, right?\n\nRuben: 00:01:01\n\nIt's a recent proposal.\n\nAaron: 00:01:04\n\nSo you proposed this a couple of months ago, but I think the general idea is also older, right?\n\nRuben: 00:01:09\n\nVery old.\n\nAaron: 00:01:10\n\nIt's based on an old idea called Stealth Addresses, I think, originally proposed by Peter Todd years ago.\n\nRuben: 00:01:16\n\nYeah, 2014.\n\nAaron: 00:01:16\n\nAnd this is an improvement on that, an iteration on that?\nHow would you describe that?\n\nRuben: 00:01:22\n\nYou could say that.\nSo yeah, the interesting thing is that the original proposal, I think the idea is kind of old, but the downside of this version is that you have to do a lot of work essentially to recognize that you got paid.\n\nAaron: 00:01:36\n\nOf your version.\n\nRuben: 00:01:37\n\nYes.\nAnd I think in the past, it's not like people didn't think of that, but at the time it seemed like that was going to be too much work.\nAnd Bitcoin has improved a lot over the years.\nSo actually, I think sort of like that, that thinking never got updated.\nAnd now we're at the point where we can do these kind of the verification of the blockchain quite quickly.\nAnd the library that we use, `libsecp256k1`, is very fast now.\nSo basically, it made it more viable than it was back in 2014.\n\nSjors: 00:02:15\n\nAnd for the loyal listeners, we did an episode about `libsecp256k1`.\nI think it's episode two.\n\nAaron: 00:02:24\n\nReally?\n\nRuben: 00:02:25\n\nOh, wow.\n\nAaron: 00:02:26\n\nThat's Sjors for you.\nYou'll remember everything.\nYou'll remember me.\nOkay, So we can maybe get into the comparisons later, but for now, what is the general idea?\nWhat's the general problem that we're solving?\n\nRuben: 00:02:38\n\nSo kind of a good way of putting it is that generally speaking, when you wanna make a payment, you have two options.\nSomeone can give an address and you can reuse that address and continually pay that person on the same address.\nAnd if you do that, then you lose all privacy because every time you receive a payment, I know it's your address and then maybe, you know, Sjors sent some money to you and I can see how many Bitcoins you have, etcetera, etcetera.\nSo because that's a problem, generally what we do is let's say, Aaron, if I want to send you a payment, I tell you, I say like, Hey Aaron, I want to send you some Bitcoin.\nCould you please give me an address?\nAnd you're sure here's an address and every time I want to pay you, you have to give me that address.\n\nAaron: 00:03:18\n\nWell, I'll generate a new address every time, right?\n\nRuben: 00:03:20\n\nYeah, generate a new one.\n\nAaron: 00:03:21\n\nIdeally.\n\nRuben: 00:03:22\n\nFresh one.\nAnd so this proposal, silent payments, allows you to basically have a single static address and allow me to derive an address from that, that nobody can recognize except for you and me.\nAnd so this makes it basically, it makes it the same process, but now it's non-interactive where I don't have to ask you for an address.\nAnd that is particularly useful when you think of things like donations, where there's a cause.\nThe cause posts one single address, and everybody goes and donates to that cause, and no interaction is required.\nSo that is basically the proposal.\n\nAaron: 00:04:00\n\nSo if I want to accept donations, then I'll post this, it's a stealth address, but you're not calling it a stealth address.\nYou're calling it a silent payment address, right?\n\nRuben: 00:04:10\n\nYes, just to differentiate, but it is essentially a form of stealth address.\n\nAaron: 00:04:14\n\nSo I'm posting this quote unquote address on my website.\nAnd then you, Ruben, in this case, can generate new addresses from this and send money there and then somehow I should be able to spend from this address.\nThat's kind of where the trick comes in.\nLike how can I spend money from addresses that you generated?\n\nRuben: 00:04:33\n\nYes.\n\n## Technical Deep Dive\n\nAaron: 00:04:34\n\nOkay.\nRuben, how can I spend money from addresses that you generated?\n\nRuben: 00:04:40\n\nSure.\nSo essentially what we do is we generate a shared secret and generating a shared secret is done by taking two public keys.\nYou have a public key, I have a public key, and because we both know one private key, you know your private key, I know my private key, we can do this calculation, which is basically a multiplication, that allows us to generate a number that you know and I know, but nobody else knows.\nAnd with this number, we can then generate a key that is sort of shared between us.\nSo it's a public key.\nYou could send money to that key, but if I were to send money to that key, both you and I could spend it, so that's not quite good enough.\nSo we add one more step after we have the shared secret, which we turn into a shared key, we then add your public key to it.\nSo now it's a combination of the shared key plus your key.\nAnd that combination is something that only you know, because I don't know your public key.\nI don't know the private key behind your public key.\n\nAaron: 00:05:41\n\nOkay, that's a lot of information in one go.\nSo let's break it down.\n\nSjors: 00:05:46\n\nSo what we did was a Diffie-Hellman exchange plus something else.\n\nAaron: 00:05:49\n\nRight, exactly.\nSo, Sjors.\n\nSjors: 00:05:53\n\nYes.\n\nAaron: 00:05:53\n\nWhat is a Diffie-Hellman exchange?\nMaybe we let, that's the first part we can break down here, I think.\n\nSjors: 00:05:58\n\nSo Diffie-Hellman was a famous rapper.\nNo, basically the idea you're taking, it's being used in browsers too, for example, right?\nSo when you connect to a website that's secure, they have a public key.\nThe website essentially has a public key and you on your computer generate another public key and you basically tell the web server hey here's my public key and then the web server can send you information in secret and you can send the the web server information to that secret.\nAnd so this really uses a very nice mathematical property, which is that if you take a private key A and you multiply it by a public key B, that is the same as when you take public key A times private key B.\nSo that means that, well, with Bitcoin we have addresses which is essentially just a combination of a private key and a public key.\nSo if I know my private key, obviously, and you know my public key and vice versa, then we can create a shared, essentially a shared address, a shared Bitcoin address where we both would own the shared Bitcoin private key and we both would own the Bitcoin shared public key.\nBut this would be utterly useless because if either of us sends money to that, then either of us can steal that money.\nWe don't want that.\n\nAaron: 00:07:22\n\nOkay.\nI'm following you, but that's also because before we started recording, I had an hour to try to understand this.\nSo to summarize this real briefly, the Diffie-Hellman exchange, two people have a public and a private key and then multiplying one public key with the other private key gets a secret number.\nBecause both persons know their own private key and the other person's public key, they can both generate this number, but no one else can generate this number because no one has either, no one else has either private key.\nOkay.\nSo from this secret number, you could potentially create a Bitcoin private key.\nYou could say that's a Bitcoin private key, essentially, and have a public key.\nAnd then basically what you were just saying, Sjors, is you could use that, like if Ruben wants to send me money, he could use that.\nWell, he couldn't, but he could send me money to that Bitcoin public key.\nAnd now we both have the private keys.\nSo the problem is then Ruben can just take the money back.\nSo yeah, I would have been paid, but I wouldn't because Ruben can claim the money.\n\nRuben: 00:08:34\n\nIt could be a feature.\n\nAaron: 00:08:36\n\nSo we need to add one more level.\n\nRuben: 00:08:39\n\nIt's a reversible payment.\nMaybe exchanges would like this, right?\nThey send money and they can take it back.\nJust kidding.\n\nSjors: 00:08:44\n\nOr you make it a two step process, right?\nWhere you receive the money on this common address and then the other side sweeps it away and wants to sweep this confirmed, but that would mean two transactions for one, but we really don't need to do that.\n\nAaron: 00:08:56\n\nSo I'm not sure if I just made it more confusing for the listener.\nThis is the way I understood it.\nSo maybe that helps.\nSo like you could now generate a Bitcoin private key and a public key.\nHowever, if you send money to that, that's not secure because you can claim the money back.\nSo there's one extra step that needs to be taken here.\nWhat's that extra step, Ruben?\n\nRuben: 00:09:15\n\nSo the extra step is that we take that shared secret, that shared key, and we add the public key of the recipients to that shared key.\n\nAaron: 00:09:25\n\nRight, so this is the same public key that I was sharing publicly, the silent payment thing that I had as a donation address.\nAnd we now add the shared...\nNo, you finish this sentence for me before I say it wrong.\n\nRuben: 00:09:41\n\nYou add the shared key to it.\nWhich is a derivative of the shared secret.\n\nAaron: 00:09:45\n\nAnd in this case, when you say adding it to it, it's basic, it's kind of like creating a two out of two multi-sig, except we use cryptographic tricks.\nIt's not actually a two of two, it looks like a wonky out of wonky, but it's sort of, it is kind of like a two of two, right?\n\nRuben: 00:10:04\n\nYou could think of it in that way, but essentially it is, basically we're using the fact that you can use elliptic curve cryptography in a way that is basically like regular math, where you can take someone's key and you can take someone else's key and you add them together.\nAnd if you do this with the public keys, the private key is also the addition of one private key with the other private key.\nSo we have two private keys essentially.\nAnd by adding those two together, we generate a key that only you know, because I know one of the private keys if I were to send a payment to you, but I don't know the other one because it's your key.\n\nAaron: 00:10:42\n\nSo the two private keys that we're adding together, to be very clear, are the shared secret private key that you were able to generate in combination with my public key, and then my actual private key that corresponds to the public key that I posted.\nSo that's the two that we're adding together to create a new private key and a new public key.\nWell, I'm the only one who can create a new private key because I'm the only one who has the private key that corresponds with my public.\n\nSjors: 00:11:11\n\nMaybe I can illustrate it from the other side, which is that if you just published your stealth address and we don't use it as a silent payment address, if you just publish an address, then anybody can send to it, right?\nIt would just be a regular transaction where you only have the private key and I have the public key.\nThe downside of that is that everybody can see what's going on.\nSo what if you just add something to this regular address?\nSo you're adding a shared key to the regular address, essentially.\nThat might even be an easier way to understand it.\nSo we just explain how you make the shared key.\nAnd then we say we take a regular address or a regular private key.\nWe just add a shared key to it so that nobody else in the world can see what's going on.\n\nAaron: 00:11:50\n\nOkay.\nSo you, Ruben, you were going to send money to my donation address.\nNow we've tried to explain how that works.\nWe've explained how that works.\nI hope people have been able to follow that.\nSo you're sending money to that address.\nNow the question is, how do I know that you did that and how do I actually generate the private key that corresponds to that?\nBecause I need to know about it, right?\n\nRuben: 00:12:17\n\nSo the first thing you need is you need to know the key that I used in order to generate the share secrets.\nBecause you know your key, obviously, and I know your key because it was publicly online on your Twitter profile or whatever.\nAnd so the key that I use is one of the keys of the inputs in the transaction that I create.\nSo if I want to send a payment to you, I create a transaction, the transaction has inputs, the inputs have a public key corresponding to them, and I know the private key of those keys.\n\nAaron: 00:12:47\n\nThis is just a Bitcoin private key, public key, just a public key that you were using anyways, that has your money on it, right?\nYes.\n\nRuben: 00:12:57\n\nSo when I create that transaction, I pick my input.\nAnd that is the key that I use to generate the new address that only you can spend.\nAnd that is where I sent the money.\nAnd so the second step, so this is how I make the payment.\nBut the second step is for you to recognize that I actually did that.\nAnd that is sort of the tricky part and sort of the downside, I would say, of this proposal, which is that in order for you to recognize that I made a payment, you have to go and check every transaction that appears on the Bitcoin blockchain.\nAnd you have to go and see if it is a payment to you.\nAnd the way you do that is basically the same way we generated this address.\nYou're also going to generate the address and you're going to see, so you're going to take the inputs, you're going to generate the shared secrets, add it to your own key, see if the result is one of the outputs.\nAnd that is how you recognize whether or not you got paid.\nSo it's a lot of effort, but the effort is all on the recipient side.\nAnd if you're running a full node already, it's relatively not a lot more effort.\n\nSjors: 00:13:58\n\nSo basically, every input of every transaction on the blockchain could be, as a recipient, could be for you.\nSo that means you have to inspect every single transaction that's on the blockchain and for every input of every transaction you want to add your shared key to it and then that generates an address and you then see hey is this transaction actually spending to that address?\nIf so, boom, you just essentially add that address to your own wallet, and then it just functions as any other wallet address would function.\n\nAaron: 00:14:31\n\nWell, I guess it's already the case that you need to check every transaction to see if there's an output for you, right?\n\nRuben: 00:14:38\n\nYes.\n\nAaron: 00:14:39\n\nSo the new part is that you have to do some extra calculations to see if the inputs and then-\n\nSjors: 00:14:47\n\nBut it's definitely a lot of extra work, right?\nSo normally what you do is when you see a transaction, you only care about the outputs.\nI mean, you care whether the transaction is valid at all.\nThat's why you look at the inputs.\nBut the outputs, the only thing your wallet needs to do is look at the `scriptPubKey` of this output, so basically the destination of the output, and then compare it to the list of addresses or ``scriptPubKey`` in your own wallet.\nSo that is just comparing one list to another list.\nThat's very cheap, but in this new scheme, you need to do basically elliptic curve key multiplication on every input, and then that gives you an address.\nSo it is significantly more work than just looking at a list.\n\nRuben: 00:15:28\n\nTo give a sort of approximate idea of how much work that is.\nIt is as if you check every signature twice instead of once.\nThat is sort of a very rough way of saying it.\n\nSjors: 00:15:43\n\nSo it definitely increases the time you need to verify blocks.\nIf you look at that from the perspective of your node is running you know, it's already synced and it's just running then one block comes in every 10 minutes your node will verify that block in a few seconds.\nSo maybe it'll take half a second longer.\nThat's fine, the bigger barrier is when you first want to sync the whole node.\nIf you want to restore from a backup, things get a little bit more hairy.\nBut I think we can get into that later.\n\nRuben: 00:17:09\n\nThat is something actually I would like to get into now perhaps because so there are-\n\nAaron: 00:17:12\n\nRuben is taking charge.\n\nRuben: 00:17:16\n\nWell, I think if we do it later, it's going to be more confusing.\n\nAaron: 00:17:19\n\nGo for it.\n\nSjors: 00:17:19\n\nIt's called Bitcoin Explained, now!\n\nRuben: 00:17:21\n\nExactly.\nSo there are a couple of things you can do to make this process faster.\nAnd so as Sjors was saying, once you're at the tip and you're validating, a new block comes in, you just have to validate everything.\nBut one of the things you can do is, there are a couple of things you can do to sort of speed it up when you re-sync a node, and you have an address, and you want to know if there's any outputs that are yours.\nSo the first thing you can do is simply have a birthday on your key and say, okay, well, I created this key in January 2022.\nSo from January 2022, I go and I check every block.\nAnd before that, I don't even bother.\nSo that's one thing you can do.\nAnother thing is that this protocol in principle is going to only create taproot outputs.\nSo any transaction that doesn't have any taproot outputs in them can be ignored.\nAnd so you don't have to check those transactions.\nThat is sort of a thing that saves a lot of effort right now, because we don't have a lot of taproot transactions yet.\nBut in time, eventually, everything's going to be a taproot transaction.\nAt least that's the hope.\nSo it's the kind of, it's an optimization that helps today, but won't help tomorrow, let's say.\nAnd then the biggest one is that instead of validating every transaction from the entire history, what you can actually do is you can take the UTXO sets and only check those outputs and see if any of those outputs correspond to a payment that belongs to you.\nAnd the downside of this is that you will have no history, so you won't be able to see any outputs that were yours and were spent, but you will find all the outputs that were unspent.\nAnd it also requires a bit more of an additional database that ties the inputs that you might require to do this calculation to the UTXO and UTXO sets.\nThere's a bit more complexity there, but the benefit there is that basically instead of scanning the entire history, you can now just take the UTXO sets, scan that, and find every unspent output that belongs to you.\n\nAaron: 00:19:36\n\nAnd then you'd need to somehow get the inputs that refers to the output.\n\nRuben: 00:18:44\n\nYes.\n\nSjors: 00:19:46\n\nSo when you look at how a node is actually built, and you know, Bitcoin Core is built in one way, but maybe Libbitcoin is built in a very different way, there are certain pieces of information that are very easy to access and certain pieces of information that are a little bit more work to access, and that can really matter with a proposal like this.\nBecause if the information, for example, is sitting in your RAM memory, that's very quick to access.\nIf on the other hand, you need to go on a disk, it's very slow to access.\nAnd you may have a pruned node, where a pruned node throws away all blocks so if you need any information that is in an old block then things get really really really slow because either you just can't get the information or you'd have to download the block again and then get it.\nSo those details matter and one of the things that I think needs to be done, and you're working on it, or you're having other people work on it, or you're hoping other people work on it, is benchmarking.\nAnd this benchmarking basically could do things like, okay, we could change the proposal and do a little bit more signature verifications, or we could change the proposal in some other way, which means we need to do more disk reading.\nAnd now let's try on the Raspberry Pi with the real blockchain, what performs better, what performs worse, that sort of stuff.\n\n## Comparison with earlier proposals\n\nAaron: 00:20:59\n\nIs this a good time to get into the comparison with the earlier proposals?\nOkay.\nSo how does this compare to earlier proposals?\n\n### Original stealth address proposal\n\nRuben: 00:21:11\n\nSure.\nSo the original stealth address proposal by Peter Todd, that one basically is quite similar, but the thing that was different is that because the scanning requirement was seen as something that was too much effort.\nSo instead of taking the key from the input, the idea was that when you generate a payment, you add an `OP_RETURN` to it.\nAnd in the `OP_RETURN`, you add a key.\nAnd then that is the key that is being used.\nAnd the downside of this-\n\nAaron: 00:21:45\n\nSo in that case, the sender's key, in your proposal, the sender's key is actually just the Bitcoin key, the one you're using to send money from.\nIn this earlier proposal by Peter Todd, there's sort of a special key that's not the same key as the one that you used to spend money from, right?\nAnd that's included in an `OP_RETURN`, a bit of extra data in the transaction.\n\nRuben: 00:22:10\n\nYeah, and so when you do that, obviously you add more overhead because now you have an `OP_RETURN`.\nAnd the upside from the recipient side, well, it's sort of a half upside because one of the upsides is you still have to scan every transaction, but now you only have to scan every transaction with an `OP_RETURN` attached to it.\n\nSjors: 00:22:30\n\nAnd you only have to look at that `OP_RETURN`.\n\nRuben: 00:22:31\n\nYes.\n\nSjors: 00:22:32\n\nIt's a lot less math than you need to do in your proposal.\n\nRuben: 00:22:36\n\nYeah, and the database lookups and stuff are easier too, because you don't have to go back and find the inputs.\nIt's right there in one of the outputs.\nSo it's sort of an in-between solution that never really got popular.\nAnd I think even the BIP itself was never finished.\n\nAaron: 00:22:55\n\nI guess one of the downsides is it makes transactions bigger because now you've got to include an `OP_RETURN`.\nSo, you know, box fill up faster if a lot of people do that and fees go up.\n\nSjors: 00:23:06\n\nThere's also a privacy downside.\n\nAaron: 00:23:08\n\nIt's sort of an indicator that it might be a stealth payment, right?\nEven though you're not sure, but if it's an indecipherable `OP_RETURN`, then that seems kind of likely.\n\nSjors: 00:23:18\n\nWell, it also means that other people looking at the blockchain can see how many \"friends\" you have.\nSo because the number of `OP_RETURN`s to your stealth address that's publicly known, people can discount them.\nOr is it not?\n\nAaron: 00:23:32\n\nThat's not probably-\n\nSjors: 00:23:32\n\nThat's only a BIP-47 then.\n\nRuben: 00:23:34\n\nYou're confusing it too now.\nNo, no, so that's not quite true.\nIt is sort of a general, you see a bunch of transactions with `OP_RETURN`s and those are all stealth payments, but you don't know who those payments are going to.\nAnd the recipients have to check all those specific addresses.\nSo it's sort of an in-between solution where you could say like, it's sort of like my proposal, but instead there's a tag that says, okay, this is a stealth payment.\n\nAaron: 00:24:00\n\nAnd this might be a stealth payment.\n\nRuben: 00:24:03\n\nWell, I think it's quite obvious, unfortunately.\n\nSjors: 00:24:06\nOk, so the `OP_RETURN` is only indicating that it's a stealth payment.\nAnd then after the `OP_RETURN` is the shared key.\n\nRuben: 00:24:12\n\nYes.\n\nSjors: 00:24:12\n\nSo, in that case, you could probably do that with just combining signatures, and then you're pretty much back to your proposal, right?\nInstead of using `OP_RETURN`, you would just basically use some sort of added key or tweak key, and you just have to check every key.\n\nRuben: 00:24:31\n\nSo there's a lot of similarity.\nAnd I think the stealth address proposal also had the suggestion of adding sort of yet another identifier of saying like, okay, well, instead of checking every `OP_RETURN`, we mark it where, let's say, you pick a number between, let's say, zero and 64 or something.\nAnd so my stealth payment is let's say 64 exactly.\nSo whenever in the `OP_RETURN` it says number 64 and then there's a public key, I only check those.\nSo it reduces the anonymity set even further, but it also lowers the scanning requirements.\n\nSjors: 00:25:06\n\nExactly.\nYour proposal is a lot of work, but a stealth transaction will look exactly the same as any other transaction.\n\n### BIP47\n\nAaron: 00:25:13\n\nOkay.\nAnd then there's,\nWhat is it?\nBIP47?\n\nRuben: 00:25:17\n\nThat is correct.\n\nSjors: 00:25:18\n\nAnd that uses the concept of a handshake, I would say.\nSo you publish your stealth address or whatever it is.\nI think they use a PayNym as a term for some people.\n\nRuben: 00:25:27\n\nThat is a term that Samurai Wallet uses, and I think Sparrow wallet has it implemented as well, but that's just the implementation.\nIn principle, it's BIP47.\n\nSjors: 00:25:36\n\nSo you publish this, essentially, public key, and then when you want to send somebody money using that, you do an announcement transaction first.\nI think you send a `OP_RETURN` payment to that address or something like that.\n\nRuben: 00:25:54\n\nThat's correct.\n\nSjors: 00:25:54\n\nAnd that `OP_RETURN` then includes some sort of key that the recipient now knows, okay, I now have a new friend and I need to start monitoring the following addresses.\nSo in this case, from one single transaction, you as the recipient can now generate a whole set of addresses that you just monitor as if you got an xPub.\nAnd so that's nice.\nThe downside is in this case of what I said before, incorrectly for the other one, is now everybody can see how many friends you have.\nBecause at this handshake address is going to be a bunch of `OP_RETURN` transactions to that address so you can count, you know, a maximum of the number of friends you have.\nI guess somebody could pretend that there are like five people.\nAnd it adds a little bit of bloat to the blockchain.\n\nAaron: 00:26:39\n\nSo that seems to be the biggest trade-off.\nIs that right?\nSo your proposal, Ruben, doesn't add any extra data to the blockchain.\nAnd then the trade-off is that the recipient has to do quite a bit of work because it has to check all the transactions.\nWhile the other proposals in their own ways, they add more data to the blockchain, but then it is easier after you've done that.\nAnd then there's more nuances, but is this-\n\nRuben: 00:27:04\n\nWell, with the stealth addresses, there's still a lot of work to do.\nSo I think the stealth addresses are sort of just old and outdated, and I think you can just sort of leave those aside.\nBut for BIP47 specifically, yes, there is not the scanning requirements.\nSo what you said is correct for BIP47, but to add a little bit to the downsides.\nWhen you create this notification transaction, you're also spending one of your outputs to create that notification.\nAnd then those outputs that you're using can then not be used for regular payments if you want to stay anonymous.\nSo it's sort of like you have to sort of, the money that you use to create the notifications need to be kept completely separate from the money that you use to pay people.\nAnd that is in general very difficult for wallets to implement.\nAnd a lot of wallets haven't implemented this correctly.\nAnd so there's a lot of potential there for sort of privacy leaking, unfortunately.\n\nSjors: 00:27:59\n\nSo You think you have a stealth address, you think you're sending anonymously, but actually because of that announcement, somebody else can just still see exactly, both from the sender side, they can just see that the sender was doing this, but also it means the recipient loses anonymity because if the sender screw up, you can tell the recipient received this many coins because of this correlation.\nSo that's a risk.\n\nRuben: 00:28:21\n\nBut one thing that's maybe interesting to note is that in Prague, I had a discussion with a couple of other developers, namely Martin and Alekos.\nAnd we have sort of thought of an idea to sort of make BIP47 better and make it so that the notification transaction can be outsourced to someone else.\nSo there's maybe a way to sort of mitigate that for BIP47.\nAnd then the only downside that you are left with is the fact that it uses additional on-chain space.\nAnd other than that, it sort of functions.\nSo that would sort of make the comparison a little bit more favorable in terms of comparing silent payments with BIP-47.\nBut still there is sort of this, this difference in on-chain space usage, which is particularly problematic for single payments.\nWhen you want to send a one-time donation to someone, then, you know, that overhead of that notification is quite significant.\n\n### Other generic schemes\n\nSjors: 00:29:20\n\nMight be useful also to compare to some other generic schemes to solve the same problem.\nSo one is that instead of publishing...\nWell, one is that it requires a little bit of interaction.\nSomebody has to send you an email anonymously and you reply with an xPub and now they can just send whatever they want to that xPub.\nThat's one thing you can do.\nYou can run a little Tor hidden service that will just hand out xPubs to anybody who asks.\nThat is a problem with, you know, denial of service and of course you have to run server.\nDenial of service means basically somebody could ask you for an xPub and then ask you for an xPub and ask you for an xPub.\nAnd then for every time you've given out an xPub, you've got to monitor like a thousand addresses forever.\nSo that's one thing.\nAnother obvious thing you can do is use Lightning because with Lightning, you have a public key and something like a Bolt 12 tattoo.\nOnce that's finalized, we'll make it just very easy to receive money, but it means some...\nThat puts a bit more burden on the sender, definitely not as much burden on the recipient, because what you're proposing doesn't sound more difficult than running a Lightning Node.\nAt least not more resource intense than running a Lightning node.\nBut for the sender, of course, they have to run a Lightning node.\n\nRuben: 00:30:36\n\nIt's interactive, essentially, when you use Lightning.\n\nAaron: 00:30:40\n\nBut Ruben just promoted to the base chain, so.\n\nRuben: 00:30:43\n\nNow we're moving back to the base..\n\nAaron: 00:30:47\n\nDon't kick him back to Lightning.\nLet him enjoy his stay here.\n\nSjors: 00:30:51\n\nAnd on the base chain, you can run a BTCPay Server or something like that that will give out a unique address every time.\nThat's a little bit less of a DDoS problem than an xPubs.\n\nRuben: 00:31:03\n\nI mean, you still have to give out a new address, right, for BTCPay Server.\nI still think it's a problem.\nI wonder how they solved that problem, actually, because you have the same issue where if you continually ask for addresses.\n\nSjors: 00:31:11\n\nBut an xPub represents a thousand addresses, so your problem is a thousand times bigger, but it's the same type of problem.\n\nRuben: 00:31:18\n\nTrue.\nAnd so just to sort of generalize, I think the sort of the trade-offs that you're mentioning here is one of interactivity, where with silent payments, the nice thing is it is just entirely non-interactive.\nBut you are absolutely correct that, you know, given sort of like the complexity of what you said, it is possible to solve this with interaction.\nAnd that is essentially what we started off with, with me saying, okay, well, if Aaron just gives me a new address every time I want to send a payment to him, that works too.\n\nAaron: 00:31:49\n\nThe whole point is to make this non-interactive.\n\n## Using DNS to announce your address\n\nSjors: 00:31:53\n\nI wanted to mention one cool possibility that I saw somebody bring up on one of the threads that related to this, which is the idea of using DNS or the `/.well-known/` URL to announce your address.\nSo what you can do is if you run a web server or React, you have a provider that does that for you, is you could say, well, If somebody types in my email address, then the wallet will just basically know where to look, either in the DNS record or at a specific spot on the web server, and it will get the key there.\nSo then, if you have a very smart wallet, I could imagine that I just type somebody's email address and it'll see, oh, is there a silent payment ID there?\nIs there a Bolt 12 invoice there?\nIs there an LN URL thing there?\nI'll just pick one of those three, and I'm going to send the money to it.\nSo from a usage point of view, it's very nice to have these static identifiers.\n\nRuben: 00:32:50\n\nI see what you mean.\nThat's interesting.\n\nSjors: 00:32:53\n\nAnd I also have a downside, but that might be solvable.\nAnd that is what I would call the Hotel California problem.\nBecause basically once you've given out this thing, people can keep paying to it forever.\nAnd at some point you might realize, ah, this running this extra thing on my node is pretty heavy.\nI'd like to downgrade.\nI'd like to stop using this.\nAnd I think that can be solved by just putting an expiration date into them.\nLike saying like, okay, don't send coins to me after this block height.\nThat would just be part of the standard.\nAnd then you scan a few hundred thousand or you scan like 10,000 bucks extra, just to be sure.\nBut you definitely want to make sure that people can opt out of this stuff.\nBecause with Bolt 12, that's not a problem, right?\nWith Lightning, you still have to ask an invoice.\nAnd if the server doesn't respond, you don't send money to it.\nBut with this, if somebody sends you money 50 years from now, like your descendants will have to like scan the whole blockchain.\n\nRuben: 00:33:46\n\nThat is a good point.\nAnd that's something I hadn't really thought about.\nBut I agree that it would be nice to support maybe a date at which you stop, well, either you stop using the address or you have to refresh the address as to say like, okay, well now I'm going to accept it for longer.\n\nSjors: 00:34:04\n\nSo that's when you combine it with this DNS server system, your wallet would just ask again and you could have very short expiration dates even on them.\nThat's not necessarily the case, but you could use the same payment code again.\nYou could just say like, okay, I'm only gonna guarantee this thing for like a week.\nAnd then if you ask again next week, I'll say, okay, no, don't worry.\nYou can use the same key.\nIt's gonna be valid for another week.\nSomething like that.\nThat's, I mean, I have a whole bunch of like implementation stuff, but I don't think we have to get there.\n\nRuben: 00:34:34\n\nThat's interesting though, but yeah.\n\nAaron: 00:34:35\n\nHow long have we been recording, Sjors?\n\nSjors: 00:34:37\n\n33 minutes.\n\nAaron: 00:34:38\n\nHow deep are we into this stuff?\nBecause there's a lot more in the show notes, or at least there's some more in the show notes.\n\nRuben: 00:34:44\n\nSure.\n\nAaron: 00:34:44\n\nLike, do we want to get into that?\n\nSjors: 00:34:46\n\nI've covered everything I wanted to cover, but...\n\nRuben: 00:34:48\n\nI guess the one thing...\n\nAaron: 00:34:50\n\nThere's this...\nGo on, Ruben.\n\nRuben: 00:34:52\n\nJust one thing I wanted to mention maybe is that I think what's good to point out here is that the scanning downside really is mainly a downside if you're not running a full node.\nIf you're running a full node, the way I look at it is that we still have to get these benchmarks.\nAnd so as Sjors already mentioned, there's a pseudonym called W0XLT, who I'm trying to collaborate with a little bit now in order to get these benchmarks.\nAnd he's already created an implementation.\nAnd once we have those, we can get a better idea.\nBut my feeling is that we can get it down to a level where if you're running a full node and you're doing this additional computation to receive these silent payments, it is not a lot of extra overhead.\nSo from that perspective, I think you could say that sort of the overhead is practically zero if you're already running a full node.\nAnd then for light clients, the problem is that even though, like many of the light clients, most of the light clients we have today, they share an xPub with whatever server is running the light client for them.\nAnd if you give out your xPub to a server, you lose all your privacy.\nSo it's actually very difficult to have a ligth client and have privacy at the same time.\nIt's not impossible.\nWe have a BIP 157 and 158, that is a compact block filters.\nSo you could have sort of a light client that preserves your privacy better.\nBut as far as I know, it's maybe Wasabi wallets.\nAnd I'm not even sure some lightning wallets maybe use it.\nBut other than that, most wallets don't really do that today.\nSo my argument there is sort of that if you care about privacy, you already sort of have to run a full node.\n\n## Implementation and Future Directions\n\nAaron: 00:36:39\n\nAnd so you mentioned there's a pseudonym working on this.\nSo how concrete is this?\nAre we going to, when am I going to be able to use this?\n\nSjors: 00:36:47\n\nI did run the demo today on Signet.\n\nRuben: 00:36:50\n\nCool, talk about it.\n\nSjors: 00:36:50\n\nSo that was fun.\nSo the pseudonym you talked about, let's call him Ox.\n\nRuben: 00:36:56\n\nOx, yeah, it's easier.\n\nSjors: 00:36:59\n\nCreated a pull request on Bitcoin Core that is like really marked as like this is just a proof of concept.\nDon't merge this.\nDon't even use this with real coins, right?\nAnd it allows you to create a wallet that can receive silent payments and it allows you to use any wallet really to send silent payments.\nAnd you know, it requires a little bit of manual stuff, but it worked.\nI mean, at least it seemed to work.\nI haven't checked if the math actually worked.\nIf somebody steals my Signet coins, I don't care for real coins.\nI want to be a little bit more sure that this is right.\nI have some remarks in mind that I'll probably post before the show comes out.\nBut I mean, if you look, I mean, there are different approaches to get a new proposal like this done, right?\nAnd I would congratulate you.\nI think this is the first time or the fastest ever that you've gone from like proposing something really complicated to something that actually demos the concept.\nAnd I personally, I like running code to understand something better.\nAnd so, and then when I looked at it, like this approach of changing Bitcoin Core to support it is one approach.\nAnother approach could be something like what Specter Wallet does is you create a tool that people download or install that is separate from Bitcoin Core, but that uses Bitcoin Core wherever it's useful.\nAnd so I looked at both possibilities and both are not trivial in this case.\nFor details I don't think we necessarily have to go into, but this proposal, I don't think this pull request will ever, well, will not get merged in the short run, even if he improves everything.\n\nAaron: 00:38:31\n\nNot in Bitcoin Core.\n\nSjors: 00:38:32\n\nNo, and a couple of reasons for that is because it essentially requires another index, which takes up space and it is, you know, like you said, it's maybe not the worst extra performance downside, but it's still pretty significant.\nYou know, it still adds.\nSo I think Bitcoin Core would not very quickly commit to a feature that it has to maintain forever that really eats a lot of resources and may screw with other proposals that might enhance scaling, like how does this combine with assumeUTXO or how does this combine with Utreexo or...\nSo that's why I think it's better to go for a separate tool.\nOn the other hand, any demo that works, I'm happy with it.\nI don't really care how it's done, whether the demo is a modified version of Bitcoin Core or a little Python script.\nI don't think it matters as long as people play with the demo because standards will get much better when people actually try them.\nOtherwise you get things like BIP32 and like, oh, gap limits.\nI guess we should have thought about that before we defined a standard.\nSo yeah, I'm happy to see that.\nI just would want to caution the listener and this is probably gonna take a while.\n\nRuben: 00:39:43\n\nI agree with that.\n\nSjors: 00:39:45\n\nBecause I guess I should explain the other side of it.\nIf you make a separate tool, now you're no longer a first class citizen of Bitcoin Core.\nSo you have to communicate through Bitcoin Core, through the RPC, and it has very limited features, very limited things you can do.\nAnd one of the things you may want to do is very tightly integrate with block validation.\nSo when a block comes in, you want to do some processing specifically for the wallet.\nYou can't do that right now with Bitcoin RPC.\nSo yeah, it's tricky.\n\nRuben: 00:40:11\n\nThere's some complexity there.\nBut yeah, at a high level, I agree with you.\nAnd so one of the things that's sort of tricky for me is that actually spacechains is sort of the project that I'm currently focused on.\nAnd now this silent payment thing, it was supposed to be sort of a side project where I thought like, okay, I'm just going to put this out on a gist and then I'm done with it.\nAnd then people start running with it and this Ox guy, he implements it.\nAnd now I'm like, okay, shit, I got to put some effort into this as well now.\nSo I'm being pulled into multiple directions, but it's a good thing because it's a success story, I guess.\n\nAaron: 00:40:48\n\nI mean, spacechains is literally a side project, right?\n\nRuben: 00:40:52\n\nIt's a sidechain project, yes.\n\nSjors: 00:40:54\n\nThat's the pun of the week.\n\nRuben: 00:40:55\n\nGood joke, yes.\n\nSjors: 00:40:56\n\nAll right, it's a good pun.\nI have another pun on the GitHub comment, but it's not for here.\n\nRuben: 00:41:03\n\nAll right, well, I'll look forward to hearing that offline.\n\nAaron: 00:41:06\n\nI cannot wait, Sjors, to read that.\n\nSjors: 00:41:08\n\nIt's gonna be amazing.\nOkay, I think that covers everything.\n\n## Coinjoins and Silent Payments\n\nRuben: 00:41:12\n\nIs there anything, Aaron, I think there's something you wanted to bring up still, or am I mistaken here?\n\nAaron: 00:41:17\n\nI mean, I was gonna ask about Coinjoin.\n\nRuben: 00:41:22\n\nAh, yes, of course.\n\nAaron: 00:41:23\n\nThat seems like opening up another can of worms.\nI don't know if we wanna go there.\nThat is true.\nNow that I've brought it up, we can't really ignore it completely.\nDo you want to summarize this in like a minute?\n\nSjors: 00:41:36\n\nI think we should briefly look at the worms.\n\nRuben: 00:41:38\n\nI agree.\nNow that's actually a good one to point out.\nSo I think this is one of these things that I feel most uncomfortable with in terms of, like, because ideally what you want to do is you want this protocol to not get in the way of how people do transactions.\nAnd so far, the way we've described it, it sort of works really well if there is one sender, if I create the transaction.\nBut what if we wanted to create a transaction as a Coinjoin where we have multiple people adding their inputs?\nAnd so the first issue is that you sort of have two variants of...\n\nSjors: 00:42:14\n\nAnd then one of the recipients is a stealth address.\n\nRuben: 00:42:17\n\nExactly.\nYes, yes.\nThat's good to add.\nThank you.\nSo the first issue is sort of that you have two variants that you could do for a sign of payments.\nWell, there are more variants, but these are the two sort of main ones, which is either you pick one input and you use that to generate the shared secret, or you pick the combination of all the inputs.\nAnd this is particularly relevant with Coinjoins because if you pick just one input, then what that means is that if someone pays you in a CoinJoin, then the recipient normally doesn't know what your input was.\nSo that's actually very good for privacy.\nBut if you use the silent payments, now if it's just with a single input, you can see which input was paying you.\nAnd so that leaks some privacy for the sender.\n\nAaron: 00:43:03\n\nYou can see which input pays you because that's the one that adds up to your new address.\n\nRuben: 00:43:08\n\nExactly.\n\nAaron: 00:43:09\n\nThere's only one input that matches your new address.\n\nRuben: 00:43:11\n\nYes.\nAnd so that's solvable by saying, okay, well, we pick all the inputs instead.\nAnd we add those inputs together and we use that to generate the shared secret.\nBut once you do that, you need the collaboration of all the Coinjoin participants.\nAnd in fact, you need them to generate a shared secret.\nAnd you also don't want them to know who you are paying.\nSo you need to get them to give you their shared secret in a way that they don't know what they're giving to you.\nAnd there's a protocol for that too, which is basically a blind way of doing a Diffie-Hellman, which is also used in e-cash.\nLong story short, a lot of complexity.\n\nAaron: 00:43:48\n\nA lot of worms.\n\nSjors: 00:43:49\n\nAnd you're actually making the single, the simple case, you're making that more complicated by aggregating the signatures.\nBecause normally when I use a wallet to make this silent payment, I just need to pick one coin, one input, and then if the wallet needs to, it can just add more inputs to that transaction and it will still work.\nBut if you want to have all the inputs count towards the shared key, then I need to decide before I have the destination address, I need to decide which coins I'm going to use.\nAnd so then you have the coin selection process separate from the payment process and that at least in Bitcoin Core, that's going to give you another can of worms that I recommend not opening.\nThere are solutions to it.\n\nRuben: 00:44:28\n\nWell, the other thing that's sort of nice about adding all the input keys together and why I sort of gravitate towards that is that it essentially cuts down the scanning requirement in half, because now instead of having to scan every individual input, you can scan the aggregation of all the inputs.\nAnd on average, a transaction has two inputs.\n\nSjors: 00:44:46\n\nThat's true, but that's where the benchmarking has to come in, because I would not be surprised at all if the, whether you look at inputs individually or you add them up, most of the work is probably going to be in fetching the original transactions from some disk somewhere.\nAnd then the actual elliptic curve math is gonna be much less than that because in general it takes a long time to read something from a disk it takes a very short time to do a calculation on the CPU but that could be completely wrong that's why you want to benchmark this stuff.\n\nRuben: 00:45:16\n\nSo I am sort of I have the same concern in terms of this needs to be benchmarked and we need to compare it all.\nAnd quite frankly, I even think that maybe the UTXO set scanning is overkill too.\nMaybe it's just better to just do the entire scanning when you do IBD and maybe that's sufficient.\nSo it's sort of, yeah, it all comes down to the benchmarks basically.\nI agree with that.\n\nSjors: 00:45:40\n\nCool.\n\nAaron: 00:45:41\n\nOkay.\nI think that's our episode.\nSjors, what do you think?\n\nSjors: 00:45:46\n\nSounds good.\nI'm not going to put this thing as a tattoo on me yet.\nBut I'm going to keep it in mind.\nYep, I think that's it.\nSo thank for listening to Bitcoin\n\nAaron: 00:45:58\n\nExplained.\n\n",
    "body_type": "markdown",
    "created_at": "2022-06-09T00:00:00.000Z",
    "domain": "https://btctranscripts.com/",
    "url": "https://btctranscripts.com/bitcoin-explained/silent-payments",
    "categories": [
        "podcast"
    ],
    "tags": [
        "silent-payments"
    ],
    "media": "https://www.youtube.com/watch?v=42PMLaz7Avk",
    "authors": [
        "Sjors Provoost",
        "Aaron van Wirdum",
        "Ruben Somsen"
    ],
    "indexed_at": "2024-03-21T16:33:36.162Z",
    "transcript_by": "tijuan1 via review.btctranscripts.com",
    "summary": "In a recent captivating episode of \"Bitcoin Explained\" from Utrecht, Sjors Provoost, Aaron van Wirdum, and Ruben Somsen engaged in a profound exploration of the concept of silent payments within the Bitcoin network. This innovative proposition, an evolution of stealth addresses initially mooted by Peter Todd, signifies a leap forward from traditional second-layer solutions to enhancements on the base chain itself. The trio elucidated how advancements in cryptographic libraries have been instrumental in making silent payments a viable option, aiming to resolve the privacy issues that plague Bitcoin transactions due to address reuse or the cumbersome exchange of fresh addresses for each transaction.\n\nSilent payments introduce a novel approach to maintaining transactional privacy through the use of a static address that enables the derivation of unique, untraceable addresses for each transaction. This mechanism employs a Diffie-Hellman exchange complemented by additional steps to ensure both security and privacy. Here, a shared secret generated through the public and private keys of the involved parties facilitates the creation of a unique key accessible only to the intended recipient. This sophisticated process not only enhances privacy but also simplifies non-interactive transactions such as donations, marking a significant advancement in the quest for improved usability and confidentiality in Bitcoin transactions.\n\nThe discussion delved deeper into the technical nuances of implementing stealth addresses, highlighting the necessity for recipients to scan the entire blockchain to identify transactions meant for them. This requirement poses substantial computational challenges, prompting the speakers to explore various optimization strategies aimed at reducing the burden on recipients. These include limiting the search to transactions post the creation date of the recipient's key and focusing on transactions with taproot outputs. Despite these optimizations, the conversation underscored the ongoing technical complexities and the need for benchmarks to evaluate the trade-offs involved in integrating such privacy-enhancing features.\n\nFurthermore, the podcast explored alternative proposals aimed at enhancing privacy for Bitcoin users, discussing the merits and drawbacks of using `OP_RETURN` outputs and BIP47. Each method presents its own set of challenges, from increased transaction sizes and fees to potential privacy risks and complications in wallet implementation. The speakers emphasized the importance of finding a balance between privacy, efficiency, and usability, highlighting the role of non-interactive solutions in improving user privacy without adding undue complexity or compromising scalability.\n\nAs the conversation shifted towards the practical implications of silent payments and static payment addresses, it became evident that integrating these innovations into Bitcoin Core poses significant challenges. The discussion touched upon the complexities of coin selection in silent payments and the potential benefits of input aggregation for reducing scanning requirements. Despite the enthusiasm for these advancements, the speakers recognized the necessity of careful consideration and collaboration within the community to navigate the technical and philosophical intricacies involved in evolving Bitcoin's transaction capabilities.\n\nIn conclusion, the episode offered a comprehensive overview of the current state and future possibilities of transaction privacy in the Bitcoin ecosystem. Through a blend of technical insight and forward-thinking, Provoost, van Wirdum, and Somsen provided valuable perspectives on the dynamic nature of innovation in the field, underscoring the ongoing efforts to achieve a delicate balance between enhancing user privacy and overcoming the technical hurdles associated with new and sophisticated solutions like silent payments."
}