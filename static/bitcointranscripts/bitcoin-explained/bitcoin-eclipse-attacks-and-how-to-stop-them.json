{
    "id": "bitcointranscripts+bitcoin-explained+bitcoin-eclipse-attacks-and-how-to-stop-them",
    "title": "Bitcoin Eclipse Attacks And How To Stop Them",
    "body_formatted": "{\"type\":\"heading\",\"text\":\"Introduction\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:01:01\"}, {\"type\":\"paragraph\",\"text\":\"We're going to discuss a paper about eclipse attacks.\\nCouldn't come up with a better pun.\\nSo apologies.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:01:06\"}, {\"type\":\"paragraph\",\"text\":\"That's all you got from us.\\nIt's the paper Eclipse Attacks on Bitcoin's Peer-to-Peer Network by Ethan Heilman, Alison Kendler, Aviv Zohar, and Sharon Goldberg from Boston University and Hebrew University MSR Israel.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:01:20\"}, {\"type\":\"paragraph\",\"text\":\"That's right and it was published in 2015.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:01:26\"}, {\"type\":\"paragraph\",\"text\":\"So it's a little while ago.\\nWe're discussing this because the new Bitcoin Core release will include a new method to prevent eclipse attacks?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:01:36\"}, {\"type\":\"paragraph\",\"text\":\"That's right and it's actually something that was suggested in that paper.\\nSo to give you an idea about the speed of Bitcoin development, sometimes somebody writes a paper in 2015 and then over the years, improvements are made based on that paper and that's still happening.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:01:49\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, but this is not the first improvement based on this paper.\\nThis is one of them and this is just the reason we're doing an episode about it now.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:01:55\"}, {\"type\":\"paragraph\",\"text\":\"Correct.\\nA lot of things have already been done.\"}, {\"type\":\"heading\",\"text\":\"Understanding Eclipse Attacks\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:01:57\"}, {\"type\":\"paragraph\",\"text\":\"So Sjors, what are eclipse attacks?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost:\"}, {\"type\":\"paragraph\",\"text\":\"So an eclipse attack is when your node is only seeing your enemy, basically.\\nYour attacker.\\nYour node has connections that it makes to the outside world and there are people who connect to your node.\\nAnd if all those connections are to some evil person, then you think you're talking to the whole world, but you're actually only talking to one person so that person is eclipsing your view of the world.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:02:21\"}, {\"type\":\"paragraph\",\"text\":\"Bitcoin is a peer-to-peer network so it consists of peers that talk with each other and I think an average, regular nodes connects to how many peers?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:02:30\"}, {\"type\":\"paragraph\",\"text\":\"Usually a node connects to eight peers outbound.\\nAnd it can have up to 117 inbound.\\nThat's changed maybe a little bit, but that's the idea.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:02:40\"}, {\"type\":\"paragraph\",\"text\":\"Right, so then the idea is if you control all outbound or inbound nodes.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost:\"}, {\"type\":\"paragraph\",\"text\":\"Both.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum:\"}, {\"type\":\"paragraph\",\"text\":\"So if you control both all inbound and outbound nodes of someone else, then you can basically lie to them and they have no other connection to the network.\\nAm I saying that right?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:02:57\"}, {\"type\":\"paragraph\",\"text\":\"That's right.\\nSo basically you connect to all these nodes because you want to ask them for new transactions and for new blocks and they'll spontaneously give you new transactions and new blocks.\\nAnd so if you're only talking to one person eventually, then that person can decide not to give you certain transactions and not to give you certain blocks.\\nNow they cannot make fake things entirely, right? \\nThey can't fake signatures because you're still checking all the consensus rules.\"}, {\"type\":\"heading\",\"text\":\"Potential Consequences of Eclipse Attacks\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:03:23\"}, {\"type\":\"paragraph\",\"text\":\"Sure.\\nBut what can do then? \\nWhat's the risk, let's say I'm attacked like this.\\nI'm subject to an eclipse attack.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:03:32\"}, {\"type\":\"paragraph\",\"text\":\"The easiest thing and that's I guess, less relevant now because people are more aware of that risk in general, is they can do a double spend attack on you.\\nSo let's say you're expecting money from somebody, you're expecting coins from somebody and you see this transaction appear in your Mempool, so in your memory, but it's not yet in a block and you're happy.\\nBut now it turns out that this person is actually sending you that transaction over the wire, but to the outside world, he's sending a very different transaction.\\nAnd so then a new block arrives, but you're not going to see that block.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum:\"}, {\"type\":\"paragraph\",\"text\":\"He's sending a conflicting transaction is what you mean.\\nHe's sending the same coins to someone else?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost:\"}, {\"type\":\"paragraph\",\"text\":\"Yeah to himself probably.\\nAnd so you think you've got this unconfirmed transaction and it's going towards you and you're not seeing any new blocks, but you think, okay, I guess, this is good.\\nIt's mine.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:04:24\"}, {\"type\":\"paragraph\",\"text\":\"I wouldn't think that Sjors.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:04:25\"}, {\"type\":\"paragraph\",\"text\":\"No.\\nSo nowadays people know that accepting zero confirmation transactions is a very bad idea and for all sorts of reasons, but this is the easiest thing you can do when you can basically hide what's happening.\\nYou can tell this person one thing that you paid them and tell other people another thing.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:04:39\"}, {\"type\":\"paragraph\",\"text\":\"Right, so what if I don't trust zero conf?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:04:43\"}, {\"type\":\"paragraph\",\"text\":\"So if you do wait for a confirmation, they can still attack you using an eclipse attack, but it's going to get a lot more expensive.\\nSo they'll have to produce a block basically.\\nA valid block.\"}, {\"type\":\"paragraph\",\"text\":\"And then they give you that block and it includes the transaction so you think it's confirmed but the outside world is also producing blocks, the normal miners.\\nAnd they're hiding those normal blocks from you.\\nSo now in the outside world, that transaction never happened because there's a longer chain that's not paying you and you've just accepted there one block or maybe multiple blocks.\\nThe attack is more expensive as they have to produce more blocks.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:05:21\"}, {\"type\":\"paragraph\",\"text\":\"So the idea is if you are a miner and you want to launch this attack on someone, but you only control 10% of hash power, then usually it wouldn't work because even the blocks you produce with the fake transaction will just be orphans away.\\nBut if you also have an eclipse attack, then it could actually work because the person you're attacking, doesn't see the competing chain.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:05:45\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\\nAnd this of course reminds us why it's important for Bitcoin to be somewhat expensive because it's really expensive to produce blocks like that.\\nBack in 2015, this would've been cheaper.\\nBut another thing you can do is because now you think, okay, so they're only going to attack me if the cost of making this fake block is lower than the amount of money they're scamming you for.\\nSo unless you-\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:06:06\"}, {\"type\":\"paragraph\",\"text\":\"Which is very unlikely.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:06:07\"}, {\"type\":\"paragraph\",\"text\":\"Right.\\nUnless you're buying Teslas or all these fancy cars all the time, you don't have to worry about this, you think.\\nBut it turns out they can do something else, which is they can actually try to split miners.\\nSo they're trying to scam you, but they're also scamming to miners at the same time, basically making miners, not see each other's blocks.\\nAnd then you might have one miner producing the block attacker ones and one miner producing the block that goes to you.\\nAnd the miners don't even know that this is going on and they're wasting a giant amount of money and the attacker just robs you of a $100.\\nSo there's a lot of economic damage, but they still scam you.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:06:50\"}, {\"type\":\"paragraph\",\"text\":\"Right, so basically let's say there are two miners on network just to simplify things.\\nThen you launch an eclipse attack on one of them plus you launch an eclipse attack on me then you can have this one miner produced blocks and he doesn't see the blocks of his competitor and you send these blocks of the miner you're attacking to me and therefore we're on sort of a separate network, which could be a minority network so the miner is wasting money and I'm being cheated with fake transactions at the same time.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:07:24\"}, {\"type\":\"paragraph\",\"text\":\"Yes but the attacker still makes money.\\nSo yeah, it's important that the attacker doesn't necessarily have to produce the blocks themselves in order to profit from an eclipse attack.\"}, {\"type\":\"paragraph\",\"text\":\"Now, the good news, or I don't know if it's good news, but mining is still somewhat centralized, there's specialized networks that connect miners so this is quite difficult to do.\\nWe don't want to rely on that.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum:\"}, {\"type\":\"paragraph\",\"text\":\"Relay networks and these kinds of things.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:07:45\"}, {\"type\":\"paragraph\",\"text\":\"Exactly.\\nBut we don't want to rely on that of course.\\nIdeally, it should be impossible to eclipse anyone.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:07:52\"}, {\"type\":\"paragraph\",\"text\":\"So luckily it's getting harder over time because we're getting more solutions to make it harder.\"}, {\"type\":\"heading\",\"text\":\"Executing an Eclipse Attack\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:08:00\"}, {\"type\":\"paragraph\",\"text\":\"Exactly.\\nNodes are becoming a little bit hardened.\\nSo I guess in order to understand that, we should explain how this paper proposes that one does an eclipse attack.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:08:08\"}, {\"type\":\"paragraph\",\"text\":\"Oh yeah.\\nI almost forgot about that.\\nHow do you actually do it?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:08:14\"}, {\"type\":\"paragraph\",\"text\":\"Well, how did you used to?\\nThe idea that you...\\nThere's a couple of ingredients that you need here.\\nOne is that what nodes are doing when they start, they try to find other peers and I think we talked about that before a little bit when we talked about DNS seeds.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:08:32\"}, {\"type\":\"paragraph\",\"text\":\"Couple of episodes ago.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:08:33\"}, {\"type\":\"paragraph\",\"text\":\"Yeah.\\nBut basically, when a node has been running for a while, it has a list of addresses that it got from other peers and it's stores them in a file.\\nAnd when the node restarts, it looks at this file for all the addresses it heard of, and it starts randomly connecting to them.\\nAnd the idea here is that you try to pollute this file as an attacker.\\nYou try to give the node a lot of new addresses that you control.\\nOr that just don't exist.\\nThat's fine too.\\nAnd you kind of try to exploit the way that this node picks the addresses.\\nThat's sort of at a high level, what happens.\\nAnd so basically the node divides the addresses in buckets, it basically looks at the IP address and finds some patterns in it, like the starting letters of the IP address or deciding numbers of the IP address and it divides them across buckets that way.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum:\"}, {\"type\":\"paragraph\",\"text\":\"And I guess buckets are just a different word for lists.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:09:29\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\\nSeparate lists.\\nAnd then when it's starting up, it just tries to pick things from different buckets.\"}, {\"type\":\"paragraph\",\"text\":\"It's still get confused by the details.\\nIt doesn't really matter, but there's basically a way that it does that and you can exploit that mechanism because the mechanism has, or had a bias in it.\\nFor one thing, it tried to take very recent items from the...\\nSo if you've learned about an address recently it would be slightly more likely to use that.\\nAnd so you could exploit that, but the idea is you give the node...\\nYou start up a whole bunch of attack nodes.\\nAnd you just feed IP addresses.\\nYou connect to the victim node.\\nSo you can occupy all the inbound connections, that's easy.\"}, {\"type\":\"paragraph\",\"text\":\"And then you give it a lot of nonsense addresses and a lot of real addresses that are you.\\nAnd every time it makes a connection, it either fails because there's nothing there or it connects to you and eventually it only connects to you.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:10:25\"}, {\"type\":\"paragraph\",\"text\":\"So if I would have to simplify this probably by a lot, then let's say I have a thousand real IP addresses of other nodes and then you feed me, I don't know, 10 gazillion fake IP addresses or IP addresses that are yours, and then my nodes start to pick IP addresses, then the odds are, I'm just going to pick IP addresses that are either fake or yours and I'm not going to pick any of the real ones because I'm only picking so many IP addresses.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:10:53\"}, {\"type\":\"paragraph\",\"text\":\"Yeah.\\nAnd so part of the trick here is that you have a list of IP addresses that you know already, but every time you learn new ones you start throwing away the old ones you already knew.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:11:03\"}, {\"type\":\"paragraph\",\"text\":\"Right.\\nSo it's even worse than the sort of random example I gave.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:11:07\"}, {\"type\":\"paragraph\",\"text\":\"Yeah.\\nWell, that's the problem.\\nYou can just keep giving somebody new addresses and then eventually they won't remember any of their old addresses.\\nSo the paper runs a simulation to see how difficult it is to actually overflow all these buckets.\\nBecause maybe, it might be possible in theory, but maybe it's just too much work and the paper show said it's actually not too much work.\\nI think it's like a matter of days that you can flood it.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:11:32\"}, {\"type\":\"paragraph\",\"text\":\"So it's going to take a couple of days to basically fill the buckets, the lists of another node's IP addresses with all of your own IP addresses and fake IP addresses?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost:\"}, {\"type\":\"paragraph\",\"text\":\"Yep.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum:\"}, {\"type\":\"paragraph\",\"text\":\"What then?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:11:44\"}, {\"type\":\"paragraph\",\"text\":\"Then, the node still has connections, still has outbound connections to the real world so the question is, how can you get rid of those connections? \\nAnd the trick there is you try to make the node crash in whatever way you can make a node crash.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:12:01\"}, {\"type\":\"paragraph\",\"text\":\"What are some ways you can make a node crash?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:12:03\"}, {\"type\":\"paragraph\",\"text\":\"Well, there are hopefully no ways to make a node crash.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum:\"}, {\"type\":\"paragraph\",\"text\":\"Oh.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost:\"}, {\"type\":\"paragraph\",\"text\":\"But this is why it's extremely important to make sure you, as a developer, you don't write code that can make a node crash, because it is an important ingredient in these type of attacks, and in other attacks.\"}, {\"type\":\"paragraph\",\"text\":\"So whenever there is a bug that allows Bitcoin Core to crash, it's a pretty serious one.\\nBut you can somehow overload its RAM usage, there's been lots of problems like that, but when it crashes and it starts again, hopefully, usually automatically if you've configured a server correctly and when it starts automatically,or when it starts, it's going to look at that file of peers it knows, and it's going to try and connect to them.\\nSo it's going to look in all these buckets and it's only going to find the attacker.\\nAnd then the attacker also makes sure that it's connecting to you.\\nSo all your inbound connections are full and then you're just only talking to the attacker.\\nSo that's what you need.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:13:01\"}, {\"type\":\"paragraph\",\"text\":\"And then the eclipse attack is in play.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:13:04\"}, {\"type\":\"paragraph\",\"text\":\"Exactly.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:13:05\"}, {\"type\":\"heading\",\"text\":\"Mitigations and Solutions for Eclipse Attacks\"}, {\"type\":\"paragraph\",\"text\":\"So now are we going to solve it?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:13:08\"}, {\"type\":\"paragraph\",\"text\":\"Yeah.\\nSo what are we going to do about it?\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:13:10\"}, {\"type\":\"paragraph\",\"text\":\"What are we going to do about it Sjors?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:13:12\"}, {\"type\":\"paragraph\",\"text\":\"So as we already said, it is a numbers game.\\nYou need to give a lot of spam addresses to this node to fill up all the buckets and make sure that it only connects to you.\\nSo one very simple solution is just to have more buckets.\\nAnother is, what we said, these more recent peers that you are biased towards.\\nOne thing you can do is to not have that bias.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:13:35\"}, {\"type\":\"paragraph\",\"text\":\"Right.\\nOr reverse that bias?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:13:38\"}, {\"type\":\"paragraph\",\"text\":\"Well, then you just attack it in some opposite way.\\nWhenever there's a bias that gives you something that you can attack.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:13:45\"}, {\"type\":\"paragraph\",\"text\":\"I would imagine it's harder to attack the reversed version of that bias if you prioritize IP addresses, you already knew, then it's harder for an attacker to attack you, right?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:13:56\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\\nBut if you prioritize old IP addresses that you knew a long time ago, then they might not be there anymore.\\nSo you're constantly failed to connect.\\nSo there's a trade-off there.\\nIf you've recently heard about the IP address, it's probably still out there.\\nSo there's a bit of a trade-off, but there is one mitigation that's sort of related to this, which is that if you hear of a new address and you want to replace that, you want to put that in the bucket and therefore take something else out of the bucket, first, you check the address that's already in the bucket.\\nYou connect to it, you see if it's still out there.\\nIf it's still out there, you don't replace it.\\nSo that's called the feeler connection.\\nSo what I think a couple years ago, was merged was basically Bitcoin Core every now and then looks at that bucket, quickly connects to a node, sees if it's real and remembers that and then disconnects.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:14:46\"}, {\"type\":\"paragraph\",\"text\":\"So that is prioritizing all the addresses just in a smarter way.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:14:51\"}, {\"type\":\"paragraph\",\"text\":\"Exactly.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:14:53\"}, {\"type\":\"paragraph\",\"text\":\"And this was merged.\\nAnd what about the previous one?\\nI didn't ask, but is that one merged using more buckets?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:14:57\"}, {\"type\":\"paragraph\",\"text\":\"I don't think so.\\nI don't think using more buckets was merged.\\nBasically the paper has about 10 suggestions and some of them have been merged.\\nSome of them even before the paper came out, because obviously it was an exploitable vulnerability\\nAnd some of them much later.\\nAnother thing you can do, and that is actually what has been merged a few weeks ago.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:15:18\"}, {\"type\":\"paragraph\",\"text\":\"Which will be in the next Bitcoin Core release.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:15:20\"}, {\"type\":\"paragraph\",\"text\":\"Hopefully.\\nIs that when you restart, you try to remember some of the last connections you had and so that's what it's doing, basically.\\nIt remembers, I thinkm two connections, namely two connections that it only exchanges blocks with.\\nAnd it tries to reconnect to those, but not too often because there's straight offs everywhere, but apparently it's not a good idea to always try to reconnect to the same nodes again when you restart because for all you know, the reason you crashed in the first place is because one of those nodes was evil.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:15:54\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, the idea is that, as you explained before, you need to crash a node for a node to start up again and find, well, all of that attack IP address in this case.\\nThis attack would be countered because you're just connected to some of the same IP addresses you were already connected to.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:16:09\"}, {\"type\":\"paragraph\",\"text\":\"But now...\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:16:11\"}, {\"type\":\"paragraph\",\"text\":\"With the trade-off that maybe the one you connected to was also the one that crashed you, so you might be crashed again.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:16:16\"}, {\"type\":\"paragraph\",\"text\":\"Now another thing you can do is not have more buckets, but have more connections, more outbound connections.\\nBecause the more outbound connections you have, the more likely you are to be connecting to honest nodes.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:16:40\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, the harder it is for an attacker to control all of the IP addresses you're connected to.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:16:45\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, and you may ask yourself why wouldn't you do that?\\nWhy not just have as many connections as possible?\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:16:51\"}, {\"type\":\"paragraph\",\"text\":\"Why not have as many connections as possible Sjors?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:16:54\"}, {\"type\":\"paragraph\",\"text\":\"That's an excellent question.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:16:55\"}, {\"type\":\"paragraph\",\"text\":\"Thank you.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:16:56\"}, {\"type\":\"paragraph\",\"text\":\"The problem is that you're exchanging a lot of data and especially the transactions that are in a mempool.\\nThat is very data intense.\\nLike gigabytes and gigabytes and gigabytes.\\nSo you can't just add more connections without also increasing bandwidth use.\\nAnd there are some new proposals that we'll probably discuss in future episodes that will reduce the bandwidth needed to do these mempool synchronizations and then you can have more connections.\\nSo there's an incentive to make this data exchange more efficient.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:17:27\"}, {\"type\":\"paragraph\",\"text\":\"Plus there's the solution that some of the connections you connect to, you don't share mempool stuff, you only connect blocks.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:17:34\"}, {\"type\":\"paragraph\",\"text\":\"That's right.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:17:34\"}, {\"type\":\"paragraph\",\"text\":\"I guess that's also one of the solutions mentioned in the paper isn't it?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:17:37\"}, {\"type\":\"paragraph\",\"text\":\"I believe it is.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:17:38\"}, {\"type\":\"paragraph\",\"text\":\"But we sort of already spoiled it in the previous solution.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:17:41\"}, {\"type\":\"paragraph\",\"text\":\"We may have.\\nSo one of the ways to have more connections, to have the upside of more connections without the downside of more bandwidth is to only exchange blocks with those extra connections, because that happens much less frequently.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum:\"}, {\"type\":\"paragraph\",\"text\":\"It still costs a little bit of an extra bandwidth.\\nBut much less, not nearly as much.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost:\"}, {\"type\":\"paragraph\",\"text\":\"And this, again reminds us that you need to wait for confirmations because those extra connections will tell you about new blocks.\\nThey won't tell you about new stuff in the mempool, but that's fine if you wait for confirmations.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:18:11\"}, {\"type\":\"paragraph\",\"text\":\"Is there more?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:18:12\"}, {\"type\":\"paragraph\",\"text\":\"Well, I mean, you can always use the Blockstream satellite or something like that as another source of data.\\nOf course that's not a universal solution, but it is a really-\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:18:21\"}, {\"type\":\"paragraph\",\"text\":\"It is almost, I think.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:18:23\"}, {\"type\":\"paragraph\",\"text\":\"Well, you would be trusting Blockstream.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum:\"}, {\"type\":\"paragraph\",\"text\":\"Yes.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost:\"}, {\"type\":\"paragraph\",\"text\":\"But there is an incentive for Bitcoin blocks to be broadcast in general, over satellite or AM, or from multiple sources so it's more difficult to eclipse someone because you'd have to eclipse the whole planet.\\nIf the signal is coming from a satellite, you want to eclipse somebody who's listening to that satellite and you either have to blow up the satellite connection to them or blow up the satellite itself, which everybody would notice and it'd be in the news and you'd say, \\\"Hey, there's probably something going on here.\\\"\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:18:55\"}, {\"type\":\"paragraph\",\"text\":\"Sure.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:18:57\"}, {\"type\":\"paragraph\",\"text\":\"Let's see, any other mitigations?\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:18:59\"}, {\"type\":\"paragraph\",\"text\":\"I like your adversarial mindset though, that you do recognize that that's actually a risk that someone blows up the satellite.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:19:07\"}, {\"type\":\"paragraph\",\"text\":\"Well, I mean, you don't actually physically have to blow it up, I guess.\\nYou can just tell people to stop broadcasting to it.\\nOne more solution is to have more nodes, basically, that other people don't know are yours.\\nSo if you have multiple nodes that you're using for whatever your service is, and you make sure that the outside world doesn't know all of them, then they might try to eclipse one of them, but they forgot to eclipse the other ones.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:19:34\"}, {\"type\":\"paragraph\",\"text\":\"That sounds like a good idea to me Sjors.\\nBut there were like 10 solutions in the paper.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:19:38\"}, {\"type\":\"paragraph\",\"text\":\"Yeah, there were.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:19:40\"}, {\"type\":\"paragraph\",\"text\":\"But we didn't cover them all then?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:19:41\"}, {\"type\":\"paragraph\",\"text\":\"No, we didn't because in order to cover them all, you would have to describe the attack in much more detail.\\nTo the point that even though I've read this paper probably two or three times over the past few years, I don't understand all the details, especially these buckets, the way they're filled is rather tedious.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:19:58\"}, {\"type\":\"paragraph\",\"text\":\"Fair enough.\\nSo yeah, I guess we'll put the paper in the show notes, right?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:20:02\"}, {\"type\":\"paragraph\",\"text\":\"Yes, and there's a website that links to some of the solutions that have been implemented.\\nAlthough I think the website itself is out of date now.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:20:09\"}, {\"type\":\"paragraph\",\"text\":\"What's the website?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:20:10\"}, {\"type\":\"paragraph\",\"text\":\"Well, we'll put it in the show notes because that's not easy to spell out.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:20:14\"}, {\"type\":\"paragraph\",\"text\":\"Anything else?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:20:15\"}, {\"type\":\"paragraph\",\"text\":\"No. \"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:20:16\"}, {\"type\":\"paragraph\",\"text\":\"Was this our episode on Eclipse attacks?\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:20:17\"}, {\"type\":\"paragraph\",\"text\":\"I think so.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:20:18\"}, {\"type\":\"paragraph\",\"text\":\"Nice.\"}, {\"type\":\"paragraph\",\"text\":\"Sjors Provoost: 00:20:18\"}, {\"type\":\"paragraph\",\"text\":\"That's all I've got.\\nThank you for listening to the the van Wirdum Sjorsnado.\"}, {\"type\":\"paragraph\",\"text\":\"Aaron van Wirdum: 00:20:22\"}, {\"type\":\"paragraph\",\"text\":\"There you go.\"}",
    "body": "## Introduction\nSjors Provoost: 00:01:01\n\nWe're going to discuss a paper about eclipse attacks.\nCouldn't come up with a better pun.\nSo apologies.\n\nAaron van Wirdum: 00:01:06\n\nThat's all you got from us.\nIt's the paper Eclipse Attacks on Bitcoin's Peer-to-Peer Network by Ethan Heilman, Alison Kendler, Aviv Zohar, and Sharon Goldberg from Boston University and Hebrew University MSR Israel.\n\nSjors Provoost: 00:01:20\n\nThat's right and it was published in 2015.\n\nAaron van Wirdum: 00:01:26\n\nSo it's a little while ago.\nWe're discussing this because the new Bitcoin Core release will include a new method to prevent eclipse attacks?\n\nSjors Provoost: 00:01:36\n\nThat's right and it's actually something that was suggested in that paper.\nSo to give you an idea about the speed of Bitcoin development, sometimes somebody writes a paper in 2015 and then over the years, improvements are made based on that paper and that's still happening.\n\nAaron van Wirdum: 00:01:49\n\nYeah, but this is not the first improvement based on this paper.\nThis is one of them and this is just the reason we're doing an episode about it now.\n\nSjors Provoost: 00:01:55\n\nCorrect.\nA lot of things have already been done.\n\n## Understanding Eclipse Attacks\n\nAaron van Wirdum: 00:01:57\n\nSo Sjors, what are eclipse attacks?\n\nSjors Provoost:\n\nSo an eclipse attack is when your node is only seeing your enemy, basically.\nYour attacker.\nYour node has connections that it makes to the outside world and there are people who connect to your node.\nAnd if all those connections are to some evil person, then you think you're talking to the whole world, but you're actually only talking to one person so that person is eclipsing your view of the world.\n\nAaron van Wirdum: 00:02:21\n\nBitcoin is a peer-to-peer network so it consists of peers that talk with each other and I think an average, regular nodes connects to how many peers?\n\nSjors Provoost: 00:02:30\n\nUsually a node connects to eight peers outbound.\nAnd it can have up to 117 inbound.\nThat's changed maybe a little bit, but that's the idea.\n\nAaron van Wirdum: 00:02:40\n\nRight, so then the idea is if you control all outbound or inbound nodes.\n\nSjors Provoost:\n\nBoth.\n\nAaron van Wirdum:\n\nSo if you control both all inbound and outbound nodes of someone else, then you can basically lie to them and they have no other connection to the network.\nAm I saying that right?\n\nSjors Provoost: 00:02:57\n\nThat's right.\nSo basically you connect to all these nodes because you want to ask them for new transactions and for new blocks and they'll spontaneously give you new transactions and new blocks.\nAnd so if you're only talking to one person eventually, then that person can decide not to give you certain transactions and not to give you certain blocks.\nNow they cannot make fake things entirely, right? \nThey can't fake signatures because you're still checking all the consensus rules.\n\n## Potential Consequences of Eclipse Attacks\n\nAaron van Wirdum: 00:03:23\n\nSure.\nBut what can do then? \nWhat's the risk, let's say I'm attacked like this.\nI'm subject to an eclipse attack.\n\nSjors Provoost: 00:03:32\n\nThe easiest thing and that's I guess, less relevant now because people are more aware of that risk in general, is they can do a double spend attack on you.\nSo let's say you're expecting money from somebody, you're expecting coins from somebody and you see this transaction appear in your Mempool, so in your memory, but it's not yet in a block and you're happy.\nBut now it turns out that this person is actually sending you that transaction over the wire, but to the outside world, he's sending a very different transaction.\nAnd so then a new block arrives, but you're not going to see that block.\n\nAaron van Wirdum:\n\nHe's sending a conflicting transaction is what you mean.\nHe's sending the same coins to someone else?\n\nSjors Provoost:\n\nYeah to himself probably.\nAnd so you think you've got this unconfirmed transaction and it's going towards you and you're not seeing any new blocks, but you think, okay, I guess, this is good.\nIt's mine.\n\nAaron van Wirdum: 00:04:24\n\nI wouldn't think that Sjors.\n\nSjors Provoost: 00:04:25\n\nNo.\nSo nowadays people know that accepting zero confirmation transactions is a very bad idea and for all sorts of reasons, but this is the easiest thing you can do when you can basically hide what's happening.\nYou can tell this person one thing that you paid them and tell other people another thing.\n\nAaron van Wirdum: 00:04:39\n\nRight, so what if I don't trust zero conf?\n\nSjors Provoost: 00:04:43\n\nSo if you do wait for a confirmation, they can still attack you using an eclipse attack, but it's going to get a lot more expensive.\nSo they'll have to produce a block basically.\nA valid block.\n\nAnd then they give you that block and it includes the transaction so you think it's confirmed but the outside world is also producing blocks, the normal miners.\nAnd they're hiding those normal blocks from you.\nSo now in the outside world, that transaction never happened because there's a longer chain that's not paying you and you've just accepted there one block or maybe multiple blocks.\nThe attack is more expensive as they have to produce more blocks.\n\nAaron van Wirdum: 00:05:21\n\nSo the idea is if you are a miner and you want to launch this attack on someone, but you only control 10% of hash power, then usually it wouldn't work because even the blocks you produce with the fake transaction will just be orphans away.\nBut if you also have an eclipse attack, then it could actually work because the person you're attacking, doesn't see the competing chain.\n\nSjors Provoost: 00:05:45\n\nYes.\nAnd this of course reminds us why it's important for Bitcoin to be somewhat expensive because it's really expensive to produce blocks like that.\nBack in 2015, this would've been cheaper.\nBut another thing you can do is because now you think, okay, so they're only going to attack me if the cost of making this fake block is lower than the amount of money they're scamming you for.\nSo unless you-\n\nAaron van Wirdum: 00:06:06\n\nWhich is very unlikely.\n\nSjors Provoost: 00:06:07\n\nRight.\nUnless you're buying Teslas or all these fancy cars all the time, you don't have to worry about this, you think.\nBut it turns out they can do something else, which is they can actually try to split miners.\nSo they're trying to scam you, but they're also scamming to miners at the same time, basically making miners, not see each other's blocks.\nAnd then you might have one miner producing the block attacker ones and one miner producing the block that goes to you.\nAnd the miners don't even know that this is going on and they're wasting a giant amount of money and the attacker just robs you of a $100.\nSo there's a lot of economic damage, but they still scam you.\n\nAaron van Wirdum: 00:06:50\n\nRight, so basically let's say there are two miners on network just to simplify things.\nThen you launch an eclipse attack on one of them plus you launch an eclipse attack on me then you can have this one miner produced blocks and he doesn't see the blocks of his competitor and you send these blocks of the miner you're attacking to me and therefore we're on sort of a separate network, which could be a minority network so the miner is wasting money and I'm being cheated with fake transactions at the same time.\n\nSjors Provoost: 00:07:24\n\nYes but the attacker still makes money.\nSo yeah, it's important that the attacker doesn't necessarily have to produce the blocks themselves in order to profit from an eclipse attack.\n\nNow, the good news, or I don't know if it's good news, but mining is still somewhat centralized, there's specialized networks that connect miners so this is quite difficult to do.\nWe don't want to rely on that.\n\nAaron van Wirdum:\n\nRelay networks and these kinds of things.\n\nSjors Provoost: 00:07:45\n\nExactly.\nBut we don't want to rely on that of course.\nIdeally, it should be impossible to eclipse anyone.\n\nAaron van Wirdum: 00:07:52\n\nSo luckily it's getting harder over time because we're getting more solutions to make it harder.\n\n## Executing an Eclipse Attack\n\nSjors Provoost: 00:08:00\n\nExactly.\nNodes are becoming a little bit hardened.\nSo I guess in order to understand that, we should explain how this paper proposes that one does an eclipse attack.\n\nAaron van Wirdum: 00:08:08\n\nOh yeah.\nI almost forgot about that.\nHow do you actually do it?\n\nSjors Provoost: 00:08:14\n\nWell, how did you used to?\nThe idea that you...\nThere's a couple of ingredients that you need here.\nOne is that what nodes are doing when they start, they try to find other peers and I think we talked about that before a little bit when we talked about DNS seeds.\n\nAaron van Wirdum: 00:08:32\n\nCouple of episodes ago.\n\nSjors Provoost: 00:08:33\n\nYeah.\nBut basically, when a node has been running for a while, it has a list of addresses that it got from other peers and it's stores them in a file.\nAnd when the node restarts, it looks at this file for all the addresses it heard of, and it starts randomly connecting to them.\nAnd the idea here is that you try to pollute this file as an attacker.\nYou try to give the node a lot of new addresses that you control.\nOr that just don't exist.\nThat's fine too.\nAnd you kind of try to exploit the way that this node picks the addresses.\nThat's sort of at a high level, what happens.\nAnd so basically the node divides the addresses in buckets, it basically looks at the IP address and finds some patterns in it, like the starting letters of the IP address or deciding numbers of the IP address and it divides them across buckets that way.\n\nAaron van Wirdum:\n\nAnd I guess buckets are just a different word for lists.\n\nSjors Provoost: 00:09:29\n\nYes.\nSeparate lists.\nAnd then when it's starting up, it just tries to pick things from different buckets.\n\nIt's still get confused by the details.\nIt doesn't really matter, but there's basically a way that it does that and you can exploit that mechanism because the mechanism has, or had a bias in it.\nFor one thing, it tried to take very recent items from the...\nSo if you've learned about an address recently it would be slightly more likely to use that.\nAnd so you could exploit that, but the idea is you give the node...\nYou start up a whole bunch of attack nodes.\nAnd you just feed IP addresses.\nYou connect to the victim node.\nSo you can occupy all the inbound connections, that's easy.\n\nAnd then you give it a lot of nonsense addresses and a lot of real addresses that are you.\nAnd every time it makes a connection, it either fails because there's nothing there or it connects to you and eventually it only connects to you.\n\nAaron van Wirdum: 00:10:25\n\nSo if I would have to simplify this probably by a lot, then let's say I have a thousand real IP addresses of other nodes and then you feed me, I don't know, 10 gazillion fake IP addresses or IP addresses that are yours, and then my nodes start to pick IP addresses, then the odds are, I'm just going to pick IP addresses that are either fake or yours and I'm not going to pick any of the real ones because I'm only picking so many IP addresses.\n\nSjors Provoost: 00:10:53\n\nYeah.\nAnd so part of the trick here is that you have a list of IP addresses that you know already, but every time you learn new ones you start throwing away the old ones you already knew.\n\nAaron van Wirdum: 00:11:03\n\nRight.\nSo it's even worse than the sort of random example I gave.\n\nSjors Provoost: 00:11:07\n\nYeah.\nWell, that's the problem.\nYou can just keep giving somebody new addresses and then eventually they won't remember any of their old addresses.\nSo the paper runs a simulation to see how difficult it is to actually overflow all these buckets.\nBecause maybe, it might be possible in theory, but maybe it's just too much work and the paper show said it's actually not too much work.\nI think it's like a matter of days that you can flood it.\n\nAaron van Wirdum: 00:11:32\n\nSo it's going to take a couple of days to basically fill the buckets, the lists of another node's IP addresses with all of your own IP addresses and fake IP addresses?\n\nSjors Provoost:\n\nYep.\n\nAaron van Wirdum:\n\nWhat then?\n\nSjors Provoost: 00:11:44\n\nThen, the node still has connections, still has outbound connections to the real world so the question is, how can you get rid of those connections? \nAnd the trick there is you try to make the node crash in whatever way you can make a node crash.\n\nAaron van Wirdum: 00:12:01\n\nWhat are some ways you can make a node crash?\n\nSjors Provoost: 00:12:03\n\nWell, there are hopefully no ways to make a node crash.\n\nAaron van Wirdum:\n\nOh.\n\nSjors Provoost:\n\nBut this is why it's extremely important to make sure you, as a developer, you don't write code that can make a node crash, because it is an important ingredient in these type of attacks, and in other attacks.\n\nSo whenever there is a bug that allows Bitcoin Core to crash, it's a pretty serious one.\nBut you can somehow overload its RAM usage, there's been lots of problems like that, but when it crashes and it starts again, hopefully, usually automatically if you've configured a server correctly and when it starts automatically,or when it starts, it's going to look at that file of peers it knows, and it's going to try and connect to them.\nSo it's going to look in all these buckets and it's only going to find the attacker.\nAnd then the attacker also makes sure that it's connecting to you.\nSo all your inbound connections are full and then you're just only talking to the attacker.\nSo that's what you need.\n\nAaron van Wirdum: 00:13:01\n\nAnd then the eclipse attack is in play.\n\nSjors Provoost: 00:13:04\n\nExactly.\n\nAaron van Wirdum: 00:13:05\n\n## Mitigations and Solutions for Eclipse Attacks\n\nSo now are we going to solve it?\n\nSjors Provoost: 00:13:08\n\nYeah.\nSo what are we going to do about it?\n\nAaron van Wirdum: 00:13:10\n\nWhat are we going to do about it Sjors?\n\nSjors Provoost: 00:13:12\n\nSo as we already said, it is a numbers game.\nYou need to give a lot of spam addresses to this node to fill up all the buckets and make sure that it only connects to you.\nSo one very simple solution is just to have more buckets.\nAnother is, what we said, these more recent peers that you are biased towards.\nOne thing you can do is to not have that bias.\n\nAaron van Wirdum: 00:13:35\n\nRight.\nOr reverse that bias?\n\nSjors Provoost: 00:13:38\n\nWell, then you just attack it in some opposite way.\nWhenever there's a bias that gives you something that you can attack.\n\nAaron van Wirdum: 00:13:45\n\nI would imagine it's harder to attack the reversed version of that bias if you prioritize IP addresses, you already knew, then it's harder for an attacker to attack you, right?\n\nSjors Provoost: 00:13:56\n\nYes.\nBut if you prioritize old IP addresses that you knew a long time ago, then they might not be there anymore.\nSo you're constantly failed to connect.\nSo there's a trade-off there.\nIf you've recently heard about the IP address, it's probably still out there.\nSo there's a bit of a trade-off, but there is one mitigation that's sort of related to this, which is that if you hear of a new address and you want to replace that, you want to put that in the bucket and therefore take something else out of the bucket, first, you check the address that's already in the bucket.\nYou connect to it, you see if it's still out there.\nIf it's still out there, you don't replace it.\nSo that's called the feeler connection.\nSo what I think a couple years ago, was merged was basically Bitcoin Core every now and then looks at that bucket, quickly connects to a node, sees if it's real and remembers that and then disconnects.\n\nAaron van Wirdum: 00:14:46\n\nSo that is prioritizing all the addresses just in a smarter way.\n\nSjors Provoost: 00:14:51\n\nExactly.\n\nAaron van Wirdum: 00:14:53\n\nAnd this was merged.\nAnd what about the previous one?\nI didn't ask, but is that one merged using more buckets?\n\nSjors Provoost: 00:14:57\n\nI don't think so.\nI don't think using more buckets was merged.\nBasically the paper has about 10 suggestions and some of them have been merged.\nSome of them even before the paper came out, because obviously it was an exploitable vulnerability\nAnd some of them much later.\nAnother thing you can do, and that is actually what has been merged a few weeks ago.\n\nAaron van Wirdum: 00:15:18\n\nWhich will be in the next Bitcoin Core release.\n\nSjors Provoost: 00:15:20\n\nHopefully.\nIs that when you restart, you try to remember some of the last connections you had and so that's what it's doing, basically.\nIt remembers, I thinkm two connections, namely two connections that it only exchanges blocks with.\nAnd it tries to reconnect to those, but not too often because there's straight offs everywhere, but apparently it's not a good idea to always try to reconnect to the same nodes again when you restart because for all you know, the reason you crashed in the first place is because one of those nodes was evil.\n\nAaron van Wirdum: 00:15:54\n\nYeah, the idea is that, as you explained before, you need to crash a node for a node to start up again and find, well, all of that attack IP address in this case.\nThis attack would be countered because you're just connected to some of the same IP addresses you were already connected to.\n\nSjors Provoost: 00:16:09\n\nBut now...\n\nAaron van Wirdum: 00:16:11\n\nWith the trade-off that maybe the one you connected to was also the one that crashed you, so you might be crashed again.\n\nSjors Provoost: 00:16:16\n\nNow another thing you can do is not have more buckets, but have more connections, more outbound connections.\nBecause the more outbound connections you have, the more likely you are to be connecting to honest nodes.\n\nAaron van Wirdum: 00:16:40\n\nYeah, the harder it is for an attacker to control all of the IP addresses you're connected to.\n\nSjors Provoost: 00:16:45\n\nYeah, and you may ask yourself why wouldn't you do that?\nWhy not just have as many connections as possible?\n\nAaron van Wirdum: 00:16:51\n\nWhy not have as many connections as possible Sjors?\n\nSjors Provoost: 00:16:54\n\nThat's an excellent question.\n\nAaron van Wirdum: 00:16:55\n\nThank you.\n\nSjors Provoost: 00:16:56\n\nThe problem is that you're exchanging a lot of data and especially the transactions that are in a mempool.\nThat is very data intense.\nLike gigabytes and gigabytes and gigabytes.\nSo you can't just add more connections without also increasing bandwidth use.\nAnd there are some new proposals that we'll probably discuss in future episodes that will reduce the bandwidth needed to do these mempool synchronizations and then you can have more connections.\nSo there's an incentive to make this data exchange more efficient.\n\nAaron van Wirdum: 00:17:27\n\nPlus there's the solution that some of the connections you connect to, you don't share mempool stuff, you only connect blocks.\n\nSjors Provoost: 00:17:34\n\nThat's right.\n\nAaron van Wirdum: 00:17:34\n\nI guess that's also one of the solutions mentioned in the paper isn't it?\n\nSjors Provoost: 00:17:37\n\nI believe it is.\n\nAaron van Wirdum: 00:17:38\n\nBut we sort of already spoiled it in the previous solution.\n\nSjors Provoost: 00:17:41\n\nWe may have.\nSo one of the ways to have more connections, to have the upside of more connections without the downside of more bandwidth is to only exchange blocks with those extra connections, because that happens much less frequently.\n\nAaron van Wirdum:\n\nIt still costs a little bit of an extra bandwidth.\nBut much less, not nearly as much.\n\nSjors Provoost:\n\nAnd this, again reminds us that you need to wait for confirmations because those extra connections will tell you about new blocks.\nThey won't tell you about new stuff in the mempool, but that's fine if you wait for confirmations.\n\nAaron van Wirdum: 00:18:11\n\nIs there more?\n\nSjors Provoost: 00:18:12\n\nWell, I mean, you can always use the Blockstream satellite or something like that as another source of data.\nOf course that's not a universal solution, but it is a really-\n\nAaron van Wirdum: 00:18:21\n\nIt is almost, I think.\n\nSjors Provoost: 00:18:23\n\nWell, you would be trusting Blockstream.\n\nAaron van Wirdum:\n\nYes.\n\nSjors Provoost:\n\nBut there is an incentive for Bitcoin blocks to be broadcast in general, over satellite or AM, or from multiple sources so it's more difficult to eclipse someone because you'd have to eclipse the whole planet.\nIf the signal is coming from a satellite, you want to eclipse somebody who's listening to that satellite and you either have to blow up the satellite connection to them or blow up the satellite itself, which everybody would notice and it'd be in the news and you'd say, \"Hey, there's probably something going on here.\"\n\nAaron van Wirdum: 00:18:55\n\nSure.\n\nSjors Provoost: 00:18:57\n\nLet's see, any other mitigations?\n\nAaron van Wirdum: 00:18:59\n\nI like your adversarial mindset though, that you do recognize that that's actually a risk that someone blows up the satellite.\n\nSjors Provoost: 00:19:07\n\nWell, I mean, you don't actually physically have to blow it up, I guess.\nYou can just tell people to stop broadcasting to it.\nOne more solution is to have more nodes, basically, that other people don't know are yours.\nSo if you have multiple nodes that you're using for whatever your service is, and you make sure that the outside world doesn't know all of them, then they might try to eclipse one of them, but they forgot to eclipse the other ones.\n\nAaron van Wirdum: 00:19:34\n\nThat sounds like a good idea to me Sjors.\nBut there were like 10 solutions in the paper.\n\nSjors Provoost: 00:19:38\n\nYeah, there were.\n\nAaron van Wirdum: 00:19:40\n\nBut we didn't cover them all then?\n\nSjors Provoost: 00:19:41\n\nNo, we didn't because in order to cover them all, you would have to describe the attack in much more detail.\nTo the point that even though I've read this paper probably two or three times over the past few years, I don't understand all the details, especially these buckets, the way they're filled is rather tedious.\n\nAaron van Wirdum: 00:19:58\n\nFair enough.\nSo yeah, I guess we'll put the paper in the show notes, right?\n\nSjors Provoost: 00:20:02\n\nYes, and there's a website that links to some of the solutions that have been implemented.\nAlthough I think the website itself is out of date now.\n\nAaron van Wirdum: 00:20:09\n\nWhat's the website?\n\nSjors Provoost: 00:20:10\n\nWell, we'll put it in the show notes because that's not easy to spell out.\n\nAaron van Wirdum: 00:20:14\n\nAnything else?\n\nSjors Provoost: 00:20:15\n\nNo. \n\nAaron van Wirdum: 00:20:16\n\nWas this our episode on Eclipse attacks?\n\nSjors Provoost: 00:20:17\n\nI think so.\n\nAaron van Wirdum: 00:20:18\n\nNice.\n\nSjors Provoost: 00:20:18\n\nThat's all I've got.\nThank you for listening to the the van Wirdum Sjorsnado.\n\nAaron van Wirdum: 00:20:22\n\nThere you go.\n",
    "body_type": "markdown",
    "created_at": "2020-11-13T00:00:00.000Z",
    "domain": "https://btctranscripts.com/",
    "url": "https://btctranscripts.com/bitcoin-explained/bitcoin-eclipse-attacks-and-how-to-stop-them",
    "categories": [
        "podcast"
    ],
    "tags": [
        "bitcoin-core",
        "eclipse-attacks"
    ],
    "media": "https://www.youtube.com/watch?v=UK9Yykf2aA4",
    "authors": [
        "Sjors Provoost",
        "Aaron van Wirdum"
    ],
    "indexed_at": "2024-03-21T16:33:36.104Z",
    "transcript_by": "Sjors, edilmedeiros, NeroCherubino",
    "summary": "In a recent enlightening podcast episode, Sjors Provoost and Aaron van Wirdum tackle the complex subject of eclipse attacks within Bitcoin's peer-to-peer network, drawing on significant research, including the foundational paper by Ethan Heilman et al. Eclipse attacks represent a formidable cybersecurity challenge where an attacker gains control over all of a victim's Bitcoin node connections, thereby isolating it from the network to feed false information or prevent transactions. This manipulation can lead to severe issues like double spending, where the attacker reverses a transaction on the actual network after convincing the victim of its completion. The potential for such attacks extends to misleading miners and disrupting the economic integrity of Bitcoin, highlighting a critical vulnerability within the network's infrastructure.\n\nThe mechanics behind executing an eclipse attack involve flooding a node's address list with IPs controlled by the attacker, thereby ensuring that upon restarts, especially following crashes, the node reconnects only to these malicious endpoints. Provoost and van Wirdum discussed the alarming ease with which attackers can isolate a node within days, emphasizing the seriousness of this security concern. The conversation further explored various mitigation strategies that have been implemented over time, aiming to thwart such attacks. These include increasing the number of address buckets, prioritizing connections differently, and integrating mechanisms to remember and reconnect to known good peers after a restart. The hosts also considered the possibility of expanding outbound connections to dilute attackers' influence, albeit acknowledging the bandwidth challenges associated with this approach.\n\nInnovative solutions such as leveraging Blockstream's satellite service for an alternative blockchain data source were discussed, offering a near-impenetrable method for securing data transmission against eclipse attacks. Additionally, operating multiple non-associated nodes was suggested as a practical strategy for ensuring network resilience. Through their dialogue, Provoost and van Wirdum illuminated not only the technical underpinnings of eclipse attacks but also underscored the ongoing efforts within the Bitcoin development community to safeguard against these threats. Their discussion reflects a broader narrative of continuous improvement and adaptation in the face of evolving cybersecurity challenges within the digital currency arena.\n\nConcluding their analysis, the podcast hosts emphasized the importance of staying abreast with the latest defensive measures against eclipse attacks, pointing to a recently published paper that highlights a suite of implemented solutions. The rapid evolution in the field necessitates constant vigilance and updating of security practices, a sentiment echoed throughout their conversation. By promising additional resources and maintaining an accessible discussion tone, Provoost and van Wirdum succeed in demystifying a complex issue, making their insights invaluable for anyone looking to understand the intricacies of eclipse attacks and the proactive measures being taken to counteract them. Their episode not only educates on a critical aspect of Bitcoin's security landscape but also exemplifies the effective dissemination of complex information through engaging dialogue, reaffirming their commitment to enhancing cybersecurity awareness within the digital currency community."
}