<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-01T03:17:18.846110+00:00</updated>
  <author>
    <name>Thomas Voegtlin 2023-06-14 08:09:45+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-01T03:17:18.846138+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003979.html" rel="alternate"/>
    <summary>Boltz, a lightning service provider, has implemented a submarine swap client that is separate from the user's lightning wallet. This separation allows for competition in the space and could potentially increase the user base for Lightning Loop, another lightning service. However, there is currently no way to bundle fee prepayment and main payment in the same invoice, which is necessary for certain services like submarine swaps and JIT channels.In the case of submarine swaps, Boltz is vulnerable to denial-of-service (DoS) attacks because their website shows an invoice to the user, but it would be impractical to show two invoices to be paid simultaneously. Competitors who require a dedicated wallet, like Boltz, are unable to ask for a prepayment of mining fees, unlike services like Loop by Lightning Labs that have dedicated client software.JIT channels also face a similar issue with mining fee attacks. Providers who want to protect themselves against this attack need to ask for the preimage of the main payment before they open the channel. However, this makes the service custodian and falls within European MICA regulation. Competitors who refuse to offer custodian services are excluded from the game.To address these issues, a proposal is made to extend BOLT-11, where an invoice can contain two bundled payments with distinct preimages and amounts. The semantics of bundled payments would require the receiver to wait until all the HTLCs of both payments have arrived before fulfilling the HTLCs of the pre-payment. If the main payment does not arrive, the pre-payment should be failed with a MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts their on-chain transaction.Implementing this change in BOLT-11 would level the playing field in terms of competition between lightning service providers. It would allow competitors without an established user base running a dedicated client to be protected from mining fee attacks. Additionally, it would benefit ACINQ by making their pay-to-open service fully non-custodian, potentially avoiding European MICA regulation.The proposal suggests implementing the change in BOLT-11 rather than using BOLT-12 or onion messages to avoid unnecessary complexity. The proposed change does not require the exchange of new messages and can be done in a non-interactive way.Overall, the proposal aims to enable competition and improve the functionality of lightning service providers by allowing for bundled payments in BOLT-11 invoices.</summary>
    <published>2023-06-14T08:09:45+00:00</published>
  </entry>
</feed>
