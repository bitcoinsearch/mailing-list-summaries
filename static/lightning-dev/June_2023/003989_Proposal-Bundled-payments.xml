<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-08T02:47:05.202355+00:00</updated>
  <author>
    <name>Bastien TEINTURIER 2023-06-20 16:44:17+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-08T02:47:05.202378+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003989.html" rel="alternate"/>
    <summary>In the email exchange between Thomas and Bastien, they discuss the relationship between pre-payment of mining fees and 0-conf (zero confirmation). Bastien expresses his belief that pre-payment can be combined with 0-conf and sees no reason for them to be opposed. However, he also mentions that if 0-conf were to be stopped, the solution he described would no longer work and a prepayment method would have to be used instead.Thomas then asks whether bundled payments would work with the current specification or if changes to BOLT-12 (a protocol for Lightning Network payments) would be required. Bastien explains that adding a TLV (Type-Length-Value) field to BOLT-12 invoices or onion messages would be necessary for bundled payments. He believes that a prepayment solution based on BOLT-12 offers a larger design space and the possibility of a more satisfying protocol.Bastien also mentions that he thinks it will take years for BOLT-12 to become the dominant payment method on Lightning Network, even after it is merged. However, he believes that if the proposed feature was adopted in BOLT-11 (an older version of the protocol), it could be deployed much faster. Thomas questions this assertion, stating that updating all sender and receiver software and prioritizing work on extensions to BOLT-11 may be less likely given the current focus on BOLT-12.Both Bastien and Thomas agree on the goal of leveling the field of competition between Lightning service providers. However, Bastien emphasizes the importance of building a satisfying solution on top of BOLT-12, where invoices are delivered on-the-fly and short-lived.In another part of the email thread, Thomas discusses the semantics of bundled payments. He explains that a BOLT-11 invoice for bundled payments would contain two preimages and two amounts: a prepayment and a main payment. The receiver should wait until all the HTLCs (Hashed Time-Locked Contracts) of both payments have arrived before fulfilling the HTLCs of the pre-payment. If the main payment does not arrive, the pre-payment should be failed with a MPP (Multi-Path Payments) timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts their on-chain transaction. Thomas also mentions that the main payment can still fail if the sender never reveals the preimage of the main payment.In response to Thomas' explanation, David suggests an alternative approach where the prepayment uses a keysend payment with the onion message payload indicating the payment hash to associate with the prepayment. He proposes extending BOLT-11 invoices with an extra_fee_via_keysend field, which would be smaller in size and allow for immediate implementation until an updated version of BOLT-11 or an alternative using offers becomes widely deployed.Overall, the email exchange revolves around the topic of prepayment and bundled payments in the context of Lightning Network protocols such as BOLT-11 and BOLT-12. The participants discuss the feasibility of combining prepayment with 0-conf, the potential need for changes to BOLT-12, the timeline for adoption of BOLT-12, and the goal of creating a more competitive environment for Lightning service providers. They also explore different approaches to implementing bundled payments and suggest enhancements to BOLT-11 invoices.</summary>
    <published>2023-06-20T16:44:17+00:00</published>
  </entry>
</feed>
