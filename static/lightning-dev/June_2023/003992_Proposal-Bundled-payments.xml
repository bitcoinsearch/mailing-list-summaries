<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-12T02:48:40.160246+00:00</updated>
  <author>
    <name>Steve Lee 2023-06-20 17:16:52+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-12T02:48:40.160275+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003992.html" rel="alternate"/>
    <summary>In an email exchange between Thomas Voegtlin and Bastien TEINTURIER, Thomas expressed interest in implementing BOLT-12 support in Electrum. He questioned whether bundled payments would work with the current BOLT-12 specification or if changes would be necessary. Thomas believed that it would take years for BOLT-12 to become the dominant payment method on Lightning, but if the feature was adopted in BOLT-11, it could be deployed much faster. However, Bastien pointed out that any upgrade requiring wallets to change takes years to implement, even for small changes like bech32m support. Bastien highlighted the importance of senders being aware that the payment will lead to a channel creation or splice on the receiver end. He suggested extending BOLT-12 instead of updating BOLT-11 as it requires new sender code anyway. Bastien discussed three strategies for providing JIT liquidity: asking the receiver for the preimage and a fee, opening a channel and forwarding the HTLC amount minus a fee, or pre-paying the fee and opening a channel to forward the whole HTLC amount. Currently, strategies 1 and 2 are deployed on the network because they don't require senders to be aware of JIT liquidity.Thomas proposed an extension to BOLT-11 where an invoice can contain two bundled payments with distinct preimages and amounts. This is useful for services that require prepayment of a mining fee for non-custodian exchanges such as submarine swaps and JIT channels. Thomas explained that competitors who require a dedicated wallet, unlike Loop by Lightning Labs, cannot ask for prepayment, making them vulnerable to DoS attacks. In the case of JIT channels, services that ask for the preimage first become custodians, which may fall within European MICA regulations.Thomas suggested bundling the prepayment and main payment in the same BOLT-11 invoice to solve these issues. The proposed semantics of bundled payments are as follows: the BOLT-11 invoice contains two preimages and amounts for the prepayment and main payment. The receiver must wait until all HTLCs of both payments have arrived before fulfilling the HTLCs of the prepayment. If the main payment doesn't arrive, the prepayment should be failed with an MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts their on-chain transaction.Thomas acknowledged that the proposal wouldn't prevent service providers from stealing the prepayment but believed it would level the field in terms of competition between lightning service providers. He also suggested that ACINQ would benefit from this change as it would make their pay-to-open service fully non-custodian, potentially avoiding European MICA regulation implications.In a recent mailing list post, ThomasV proposed a solution for a use case involving BOLT-11. He mentioned that his proposal does not require the use of BOLT-12 or onion messages, as he believes this would unnecessarily complicate things. Instead, he suggests that the task at hand can be accomplished in a non-interactive way without the need for additional message exchanges.ThomasV received initial feedback suggesting that BOLT-12 or OM could be used for this use case, but he maintains that adding new messages is not necessary. He emphasizes the importance of simplicity and avoiding unnecessary complexity.The post was made on the Lightning-dev mailing list, which is hosted by the Linux Foundation. The email includes contact information for Electrum Technologies GmbH, including their address in Berlin and registration details. Thomas Voegtlin is listed as the Geschäftsführer (Managing Director) of the company.Overall, ThomasV's proposal aims to address a specific use case using BOLT-11 in a non-interactive manner, without introducing new messages or complicating the process with BOLT-12 or onion messages.</summary>
    <published>2023-06-20T17:16:52+00:00</published>
  </entry>
</feed>
