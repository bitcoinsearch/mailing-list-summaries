<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>2</id>
  <title>Combined summary - Potential vulnerability in Lightning backends: BOLT-11 "payment hash" does not commit to payment!</title>
  <updated>2023-06-21T01:28:04.024776+00:00</updated>
  <author>
    <name>callebtc 2023-06-19 15:26:05+00:00</name>
  </author>
  <author>
    <name>Antoine Riard 2023-06-19 20:34:10+00:00</name>
  </author>
  <link href="lightning-dev/June_2023/003983_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml" rel="alternate"/>
  <link href="lightning-dev/June_2023/003986_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml" rel="alternate"/>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>2</id>
    <title>Combined summary - Potential vulnerability in Lightning backends: BOLT-11 "payment hash" does not commit to payment!</title>
    <updated>2023-06-21T01:28:04.024821+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003983.html" rel="alternate"/>
    <summary>LNbits, a Lightning Network wallet provider, has discovered an exploit that could allow attackers to create balances out of thin air. The exploit involves abusing a quirk in how invoices are handled internally, allowing the attacker to insert a bolt-11 payment hash of payment A into a different payment and trick the backend into believing that B == A. This means that the backend settles payment internally by crediting A debiting B, and the attacker has "created" 999 satoshis. This method requires a fundamental understanding of bolt-11 and custom tooling to produce the malicious invoice. To mitigate this issue, backends should either use self-generated unique "checking id's" for looking up internal payments or use additional checks to make sure that the invoice details have not been messed around with (e.g., asserting amount(A) == amount(B)). LNBits has already patched this issue in version 0.10.5 and urges users to update as soon as possible. Developers working on custodial wallets, payment processors, account management software, etc. are advised to be aware of this exploit and take necessary measures. It is important to note that this attack highlights the sophistication of LN-savvy attackers and the importance of naming fields accurately. The "payment hash" of an invoice is not a "payment" hash but merely a "preimage" hash, and developers should avoid implicitly assuming that the hash commits to payment details like amount, pubkey, etc.</summary>
    <published>2023-06-19T15:26:05+00:00</published>
  </entry>
</feed>
