<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>2</id>
  <title>Combined summary - Potential vulnerability in Lightning backends: BOLT-11 "payment hash" does not commit to payment!</title>
  <updated>2023-06-27T04:44:11.253194+00:00</updated>
  <author>
    <name>callebtc 2023-06-19 15:26:05+00:00</name>
  </author>
  <author>
    <name>Antoine Riard 2023-06-19 20:34:10+00:00</name>
  </author>
  <link href="lightning-dev/June_2023/003983_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml" rel="alternate"/>
  <link href="lightning-dev/June_2023/003986_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml" rel="alternate"/>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>2</id>
    <title>Combined summary - Potential vulnerability in Lightning backends: BOLT-11 "payment hash" does not commit to payment!</title>
    <updated>2023-06-27T04:44:11.253234+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003983.html" rel="alternate"/>
    <summary>LNbits team discovered an exploit that allows attackers to create balances out of thin air by abusing a quirk in how invoices are handled internally. The attacker was able to insert a bolt-11 payment hash of payment A into a different payment, creating malicious invoice B that can trick the backend into believing that B == A. The critical part of this attack is that payment hashes do not commit to any payment details like amount but only to the preimage. Backends can mitigate this issue by using unique checking ids for looking up internal payments or additional checks to prevent invoice details from being messed around with. Developers should be aware that the payment hash of an invoice is merely a preimage hash and does not commit to payment details like amount, pubkey, etc. It requires custom tooling to produce a malicious invoice and shows the level of sophistication of LN-savvy attackers. Custodial wallets, payment processors, and account management software based on LDK should not be affected if they use "create_inbound_payment" and respect API recommendations. Potential safety issues with invoices have been known since CVE-2020-26896. Good disclosure security practice suggests warning Lightning implementation maintainers beforehand on their respective security communication channels to ease patch coordination.</summary>
    <published>2023-06-19T15:26:05+00:00</published>
  </entry>
</feed>
