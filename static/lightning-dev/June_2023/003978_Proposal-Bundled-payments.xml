<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-08T02:46:26.111121+00:00</updated>
  <author>
    <name>Olaoluwa Osuntokun 2023-06-14 02:56:54+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-08T02:46:26.111144+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003978.html" rel="alternate"/>
    <summary>In a proposal by Thomas Voegtlin, an extension to BOLT-11 is suggested where an invoice can contain two bundled payments with distinct preimages and amounts. The purpose of this extension is to address the use case of services that require prepayment of a mining fee for a non-custodian exchange to take place, such as submarine swaps and JIT channels.Currently, service providers who use dedicated client software like Loop by Lightning Labs can ask for a prepayment because their software can handle it. However, competitors who do not require a dedicated wallet, like the Boltz exchange, face difficulties in asking for prepayment. Their website shows an invoice to the user whose wallet is agnostic about the swap, making it impractical to show two invoices simultaneously. This vulnerability exposes Boltz to potential DoS attacks where attackers force them to pay on-chain fees.Similarly, providers of JIT channels need to protect themselves against mining fee attacks by asking for the preimage of the main payment before opening the channel. However, this approach makes the service custodian, which can have legal implications under European MICA regulation. Competitors like Electrum, who refuse to offer custodian services, are excluded from this game.To solve these issues, the proposal suggests bundling the prepayment and main payment in the same BOLT-11 invoice. The semantics of bundled payments involve the receiver waiting for all HTLCs of both payments to arrive before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should be failed with an MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts the on-chain transaction. It should be noted that the main payment can still fail if the sender never reveals the preimage.The proposal aims to level the playing field among lightning service providers by allowing non-dedicated clients to participate without being exposed to mining fee attacks. ACINQ, in particular, would benefit from this change as it would make their pay-to-open service fully non-custodian. Currently, their pay-to-open service falls within the scope of European MICA regulation.The suggested change should be implemented in BOLT-11 rather than using BOLT-12 or onion messages. This is because the proposal does not require the exchange of new messages and can be done in a non-interactive way.</summary>
    <published>2023-06-14T02:56:54+00:00</published>
  </entry>
</feed>
