<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-11T02:38:27.484238+00:00</updated>
  <author>
    <name>Olaoluwa Osuntokun 2023-06-14 02:56:54+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-11T02:38:27.484263+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003978.html" rel="alternate"/>
    <summary>In a proposal to extend BOLT-11, Thomas Voegtlin suggests the inclusion of two bundled payments in an invoice. This would cater to services that require a prepayment of a mining fee for non-custodian exchanges, such as submarine swaps and JIT channels. Currently, service providers who use dedicated client software can ask for a prepayment, but competitors who do not require a dedicated wallet face difficulties in showing two invoices simultaneously. This vulnerability exposes them to denial-of-service (DoS) attacks where attackers force them to pay on-chain fees.For JIT channels, providers looking to protect themselves against mining fee attacks need to ask for the preimage of the main payment before opening the channel. However, this makes their service custodian, falling within European MICA regulation. Competitors, like Electrum, who refuse to offer custodian services are excluded from this game. To address these challenges, bundling the prepayment and main payment in the same BOLT-11 invoice is proposed.Under the proposed semantics of bundled payments, the BOLT-11 invoice would contain two preimages and two amounts: prepayment and main payment. The receiver would wait until all the HTLCs of both payments have arrived before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, they should fail the prepayment with a MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts their on-chain transaction. Note that the main payment can still fail if the sender never reveals the preimage of the main payment.While this proposal does not prevent service providers from stealing the prepayment, it aims to level the competition between lightning service providers. Currently, users need to use a dedicated client to use Loop, which exposes competitors without an established user base running a dedicated client to mining fee attacks. ACINQ would also benefit from this proposal, as it would enable them to make their pay-to-open service fully non-custodian. The suggested change should be implemented in BOLT-11 rather than using BOLT-12 or onion messages, as it does not require the exchange of new messages and can be done in a non-interactive way.</summary>
    <published>2023-06-14T02:56:54+00:00</published>
  </entry>
</feed>
