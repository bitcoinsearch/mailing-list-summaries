<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-13T02:57:37.218624+00:00</updated>
  <author>
    <name>Olaoluwa Osuntokun 2023-06-14 02:56:54+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-13T02:57:37.218657+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003978.html" rel="alternate"/>
    <summary>In a proposal to extend BOLT-11, Thomas Voegtlin suggests including two bundled payments with distinct preimages and amounts in an invoice. This proposal addresses the use case of services that require prepayment of a mining fee for a non-custodian exchange, such as submarine swaps and JIT channels. In these cases, service providers receive an HTLC for which they do not have the preimage and must send funds on-chain, waiting for the client to reveal the preimage when claiming the payment. To protect against the risk of non-payment, service providers ask for a prepayment of mining fees.However, some competitors, like Boltz exchange, are unable to ask for prepayment because their website shows an invoice to the user whose wallet is agnostic about the swap. It would be impractical for them to show two invoices to be paid simultaneously. This vulnerability exposes them to potential denial-of-service (DoS) attacks where attackers force them to pay on-chain fees. Similarly, for JIT channels, providers need to ask for the preimage of the main payment before opening the channel to protect against the mining fee attack. However, this approach makes the service custodial and subject to regulatory requirements like the European MICA regulation.To address these challenges, Voegtlin proposes bundling the prepayment and main payment in the same BOLT-11 invoice. The semantics of bundled payments involve waiting for all the HTLCs of both payments to arrive before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should fail with a MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts their on-chain transaction. While this proposal does not prevent service providers from stealing the prepayment, it aims to level the competition field between lightning service providers and enable non-custodian services.Voegtlin believes that implementing this change in BOLT-11, rather than using BOLT-12 or onion messages, is the most straightforward approach. He argues that there is no need to add new messages when the desired functionality can be achieved in a non-interactive way. This proposal could benefit ACINQ by allowing them to make their pay-to-open service fully non-custodian and avoid falling under the scope of European MICA regulation. Voegtlin emphasizes that this change would enhance competition among lightning service providers and eliminate the dependency on dedicated clients like Loop.</summary>
    <published>2023-06-14T02:56:54+00:00</published>
  </entry>
</feed>
