<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-01T03:17:40.543058+00:00</updated>
  <author>
    <name>Olaoluwa Osuntokun 2023-06-14 02:56:54+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-01T03:17:40.543089+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003978.html" rel="alternate"/>
    <summary>The proposal put forth by Thomas Voegtlin suggests an extension to BOLT-11, the Lightning Network specification for invoices. The proposed extension involves including two bundled payments with distinct preimages and amounts in a single invoice. This is aimed at addressing the specific use case of services that require prepayment of mining fees for non-custodial exchanges like submarine swaps and JIT channels.In the case of submarine swaps, certain service providers, such as Loop by Lightning Labs, can request prepayment because their dedicated software can handle it. However, competitors like Boltz exchange, which do not require a dedicated wallet, face challenges in requesting prepayment. These competitors show an invoice on their website to users whose wallets are agnostic about the swap. It would be impractical for them to display two separate invoices simultaneously. This situation leaves Boltz vulnerable to denial-of-service (DoS) attacks where attackers can force them to pay on-chain fees.Similarly, in the case of JIT channels, providers who want to protect themselves against mining fee attacks need to ask for the preimage of the main payment before opening the channel. However, this approach makes the service custodial, even if they open the channel immediately after receiving the preimage. This raises legal concerns, particularly falling within the European MICA regulation. Competitors like Electrum, who refuse to offer custodian services, are excluded from participating in this game.To address these issues, Thomas proposes bundling the prepayment and the main payment in the same BOLT-11 invoice. The semantics of bundled payments involve including two preimages and two amounts in the invoice. The receiver should wait until all the HTLCs (Hash Time-Locked Contracts) of both payments have arrived before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should fail with a MPP (Multi-Path Payments) timeout. Once the HTLCs of both payments have arrived, the receiver can fulfill the HTLCs of the prepayment and broadcast their on-chain transaction. However, it is important to note that the main payment can still fail if the sender never reveals the preimage.Thomas believes that implementing this change in BOLT-11 would level the playing field for competition between lightning service providers. Currently, using Loop requires a dedicated client, and competitors without an established user base running such a client are exposed to mining fee attacks. ACINQ, another lightning service provider, could also benefit from this change as it would enable them to make their pay-to-open service fully non-custodial. The current form of their pay-to-open service used by Phoenix falls within the scope of the European MICA regulation.Lastly, Thomas emphasizes that this proposal should be implemented in BOLT-11 and not through new message protocols like BOLT-12 or onion messages. He argues that the proposed changes can be achieved in a non-interactive way without introducing additional complexity.</summary>
    <published>2023-06-14T02:56:54+00:00</published>
  </entry>
</feed>
