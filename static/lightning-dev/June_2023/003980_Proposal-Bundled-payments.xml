<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-05T02:50:32.192233+00:00</updated>
  <author>
    <name>Matt Corallo 2023-06-14 17:28:04+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-05T02:50:32.192262+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003980.html" rel="alternate"/>
    <summary>In a recent discussion on the Lightning-dev mailing list, Thomas Voegtlin proposed an extension to BOLT-11, the Lightning Network's invoice format. The proposal suggests allowing invoices to contain two bundled payments with distinct preimages and amounts. This feature would be particularly useful for services that require prepayment of a mining fee before a non-custodian exchange can take place, such as submarine swaps and JIT channels.Currently, some services like Loop by Lightning Labs can ask for prepayment because their dedicated software can handle it. However, competitors like Boltz Exchange, which do not require a dedicated wallet, are at a disadvantage. These competitors cannot easily ask for prepayment without making the process cumbersome for users. This vulnerability exposes them to potential denial-of-service attacks where attackers force them to pay on-chain fees.JIT channels face a similar issue. Providers who want to protect themselves against mining fee attacks need to ask for the preimage of the main payment before opening the channel. However, this makes them custodians, which has legal implications under European MICA regulation. Competitors who refuse to offer custodian services are excluded from the game.To address these challenges, Voegtlin proposes bundling the prepayment and main payment in the same BOLT-11 invoice. The semantics of bundled payments involve including two preimages and two amounts in the invoice. The receiver should wait until all HTLCs (Hash Time Locked Contracts) of both payments have arrived before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should be failed with a MPP (Multi-Path Payments) timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts the on-chain transaction.Voegtlin acknowledges that his proposal does not prevent service providers from stealing the prepayment, but he argues that this is already a risk in the current system. He believes that implementing this change in BOLT-11, rather than introducing new protocols like BOLT-12 or onion messages, would simplify the process and make it non-interactive.Overall, Voegtlin's proposal aims to level the playing field among lightning service providers and address the vulnerabilities they face in terms of mining fee attacks and custodian services. It remains to be seen how the Lightning Network community will respond to this suggestion.</summary>
    <published>2023-06-14T17:28:04+00:00</published>
  </entry>
</feed>
