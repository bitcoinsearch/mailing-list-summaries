<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-09T02:56:05.142614+00:00</updated>
  <author>
    <name>Matt Corallo 2023-06-14 17:28:04+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-09T02:56:05.142647+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003980.html" rel="alternate"/>
    <summary>It seems unlikely that there will be any new interoperable changes to BOLT-11, as getting support for amount-less BOLT-11 invoices is already a challenge. Introducing another incompatible version of BOLT-11 and expecting the entire ecosystem to support it is not realistic.The proposal by Thomas Voegtlin suggests an extension to BOLT-11, where an invoice can contain two bundled payments with distinct preimages and amounts. This is aimed at addressing the use case of services that require prepayment of mining fees for non-custodian exchanges like submarine swaps and JIT channels.Currently, some services like Loop by Lightning Labs can ask for prepayment because their software can handle it. However, competitors who do not require a dedicated wallet, such as the Boltz exchange, cannot do the same. This creates vulnerability to denial-of-service (DoS) attacks where attackers force them to pay on-chain fees.In the case of JIT channels, providers need to ask for the preimage of the main payment before opening the channel to protect themselves against mining fee attacks. However, this makes them custodians from a legal perspective and falls within European MICA regulation. Competitors who refuse to offer custodian services are excluded from the game.To solve these issues, the proposal suggests bundling the prepayment and main payment in the same BOLT-11 invoice. The semantics of bundled payments involve waiting for all HTLCs of both payments to arrive before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should fail with a MPP timeout. Once both payments' HTLCs have arrived, the receiver fulfills the prepayment's HTLCs and broadcasts the on-chain transaction.While the proposal does not prevent service providers from stealing the prepayment, this is already a risk today. Implementing this change in BOLT-11 would level the field in terms of competition between lightning service providers. It would also benefit ACINQ, allowing them to make their pay-to-open service fully non-custodian and avoid falling under the European MICA regulation.The author suggests implementing this change in BOLT-11 rather than using BOLT-12 or onion messages. They believe that adding new messages would unnecessarily complicate things when a non-interactive approach can be taken.Overall, the proposal aims to address issues related to prepayment of mining fees in non-custodian exchanges through bundled payments in BOLT-11 invoices.</summary>
    <published>2023-06-14T17:28:04+00:00</published>
  </entry>
</feed>
