<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-05T02:51:08.220629+00:00</updated>
  <author>
    <name>Thomas Voegtlin 2023-06-20 08:45:34+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-05T02:51:08.220660+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003988.html" rel="alternate"/>
    <summary>In an email exchange, Thomas Voegtlin proposed an extension to BOLT-11, the Lightning Network protocol. The proposal suggests adding a feature where an invoice can contain two bundled payments with distinct preimages and amounts. This would be beneficial for services that require a prepayment of a mining fee for non-custodian exchanges like submarine swaps and JIT channels.Currently, services like Loop by Lightning Labs can request a prepayment because their software supports it. However, competitors like the Boltz exchange, which don't require a dedicated wallet, cannot easily ask for a prepayment. This creates a vulnerability for Boltz as attackers can force them to pay on-chain fees, potentially leading to DoS attacks. For JIT channels, providers who want protection against mining fee attacks need to ask for the preimage of the main payment before opening the channel, making their service custodian and subject to regulations.To address these issues, Thomas proposes bundling the prepayment and main payment in the same BOLT-11 invoice. The invoice would include two preimages and two amounts: the prepayment and the main payment. The receiver would wait for all HTLCs of both payments to arrive before fulfilling the pre-payment HTLCs. If the main payment doesn't arrive, the receiver would fail the pre-payment with a MPP timeout. Once both payments have arrived, the receiver fulfills the prepayment HTLCs and broadcasts the on-chain transaction.Thomas believes this proposal would level the playing field between Lightning service providers. Currently, using dedicated clients like Loop is necessary for certain services, while competitors without established user bases running dedicated clients are susceptible to mining fee attacks. ACINQ could also benefit from this proposal by making its pay-to-open service fully non-custodian and compliant with European regulations.Thomas suggests implementing this change in BOLT-11 rather than using BOLT-12 or onion messages. He argues that the proposed feature doesn't require the exchange of new messages and can be done in a non-interactive way, making it less complicated. He emphasizes the importance of technical decisions being driven by technical needs and proposes a minimalistic approach to adding new messages to protocols. Thomas believes that implementing this feature in BOLT-11 would significantly impact the Lightning ecosystem's shape and competition dynamics between service providers.Bastien Teinturier responded to Thomas' proposal, mentioning the sender's need to be aware of the channel creation or splice happening on the receiver end. He suggests extending BOLT-12 instead of updating BOLT-11. Bastien also discusses strategies for providing JIT liquidity, including pre-payment of fees and blacklisting non-cooperative clients.In the email, contact information for Electrum Technologies GmbH is provided, including its address in Berlin, Germany. The email mentions the company's registration at the Amtsgericht Charlottenburg and its HRB number of 164636. Thomas Voegtlin is identified as the Geschäftsführer (Managing Director) of the company. The email concludes with a link to the Lightning-dev mailing list provided by the Linux Foundation.</summary>
    <published>2023-06-20T08:45:34+00:00</published>
  </entry>
</feed>
