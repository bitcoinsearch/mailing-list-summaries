<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-12T02:46:11.798156+00:00</updated>
  <author>
    <name>Thomas Voegtlin 2023-06-20 08:45:34+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-12T02:46:11.798196+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003988.html" rel="alternate"/>
    <summary>In an email exchange, Thomas Voegtlin proposed an extension to BOLT-11 that would allow invoices to contain two bundled payments with distinct preimages and amounts. This proposal aims to address the need for prepayment of mining fees in non-custodian exchanges like submarine swaps and JIT channels. Currently, services like Loop by Lightning Labs can ask for a prepayment because their software can handle it, but competitors who do not require a dedicated wallet cannot. This creates a vulnerability to DoS attacks where attackers force these competitors to pay on-chain fees.Additionally, providers who want to protect themselves against mining fee attacks in JIT channels need to ask for the preimage of the main payment before opening the channel, which makes them custodians and subject to regulatory issues. Voegtlin suggests bundling the prepayment and main payment in the same BOLT-11 invoice as a solution. The proposal outlines the semantics of bundled payments, including waiting for all HTLCs of both payments to arrive before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should be failed with a MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts their on-chain transaction. However, this proposal does not prevent service providers from stealing the prepayment, which is already a risk.Voegtlin believes that implementing this change in BOLT-11 rather than using BOLT-12 or onion messages would be simpler and more efficient. He argues that the proposal does not require the exchange of new messages and can be done in a non-interactive way. Voegtlin highlights that this proposal would level the field in terms of competition between lightning service providers and benefit Lightning Labs and ACINQ in particular. It would make it possible for Lightning Labs to offer their Loop service to non-LND users and enable ACINQ to make their pay-to-open service fully non-custodian, addressing potential regulatory concerns.In response to Voegtlin's proposal, Bastien TEINTURIER points out that the proposal requires senders to be aware that the payment will lead to a channel creation or splice on the receiver end. He suggests extending BOLT-12 instead of updating BOLT-11 to accommodate this requirement. TEINTURIER also discusses different strategies for providing JIT liquidity, such as asking the receiver for the preimage and a fee, opening a channel and forwarding the HTLC amount minus a fee, or pre-paying the fee and forwarding the whole HTLC amount on that channel. He mentions that strategies 1 and 2 are currently deployed on the network, while Voegtlin is proposing strategy 3. TEINTURIER highlights that strategies 1 and 2 do not require senders to be aware of JIT liquidity, which is why they were chosen. He also suggests that if trust and regulation are the main concerns, solution 2 can work as long as the mempool isn't empty and 0-conf is still in use.TEINTURIER agrees that including the proposed feature in BOLT-12 rather than BOLT-11 makes more sense since all implementations are actively working on BOLT-12. He emphasizes the importance of considering how this feature is understood by everyone and its potential impact on the ecosystem.Overall, Voegtlin's proposal aims to address the need for prepayment of mining fees in non-custodian exchanges and JIT channels by bundling prepayment and main payment in the same BOLT-11 invoice. This change would level the competition between lightning service providers and benefit Lightning Labs and ACINQ. However, TEINTURIER raises concerns about the practicality and implementation of the proposal and suggests exploring alternative approaches.This email is a reply to a mailing list message from Electrum Technologies GmbH, a company based in Berlin, Germany. The email contains the company's contact information, including its address, registration details, and the name of its managing director, Thomas Voegtlin. The email also includes a link to the Lightning-dev mailing list hosted by the Linux Foundation. This mailing list allows developers and enthusiasts to discuss topics related to Lightning Network development. The link provided in the email allows users to access the mailing list and subscribe to receive updates and participate in discussions.</summary>
    <published>2023-06-20T08:45:34+00:00</published>
  </entry>
</feed>
