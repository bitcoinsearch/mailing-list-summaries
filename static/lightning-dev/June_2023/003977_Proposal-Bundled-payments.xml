<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-06-22T01:27:00.186856+00:00</updated>
  <author>
    <name>Thomas Voegtlin 2023-06-13 08:10:29+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-06-22T01:27:00.186881+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003977.html" rel="alternate"/>
    <summary>ThomasV has proposed an extension to BOLT-11 where an invoice can contain two bundled payments with distinct preimages and amounts. This proposal is beneficial for services that require prepayment of a mining fee before a non-custodian exchange can take place, such as submarine swaps and JIT channels. The service providers receive HTLCs for which they do not have the preimage and have to send funds on-chain and wait for the client to reveal the preimage when they claim the payment. The issue arises when a client does not claim the payment and service providers need to ask for prepayment of mining fees. The proposal would level the field in terms of competition between lightning service providers. Currently, only dedicated clients like Loop by Lightning Labs can handle prepayments while competitors who require a dedicated wallet like the Boltz exchange cannot do so. Competitors are vulnerable to DoS attacks where the attacker forces them to pay on-chain fees. In the case of JIT channels, providers who want to protect themselves against this mining fee attack need to ask for the preimage of the main payment before they open the channel. However, a service that asks for the preimage first becomes custodian and falls within the European MICA regulation. Competitors who refuse to offer custodian services, such as Electrum, are excluded from that game. The semantics of bundled payments are as follows: the BOLT-11 invoice contains two preimages and two amounts: prepayment and main payment. The receiver should wait until all the HTLCs of both payments have arrived before they fulfill the HTLCs of the pre-payment. If the main payment does not arrive, they should fail the pre-payment with an MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment, and they broadcast their on-chain transaction. ThomasV believes that ACINQ would benefit from this proposal as it would make it possible for them to make their pay-to-open service fully non-custodian. The change should be implemented in BOLT-11 and not using BOLT-12 or onion messages because the proposal does not require the exchange of new messages.</summary>
    <published>2023-06-13T08:10:29+00:00</published>
  </entry>
</feed>
