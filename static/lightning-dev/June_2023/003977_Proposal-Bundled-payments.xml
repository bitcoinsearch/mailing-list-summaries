<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Proposal: Bundled payments</title>
  <updated>2023-07-02T03:10:18.985469+00:00</updated>
  <author>
    <name>Thomas Voegtlin 2023-06-13 08:10:29+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Proposal: Bundled payments</title>
    <updated>2023-07-02T03:10:18.985497+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003977.html" rel="alternate"/>
    <summary>Proposal for an extension to BOLT-11 has been made by ThomasV. The proposed extension suggests that an invoice should be able to contain two bundled payments, each with distinct preimages and amounts. This extension is aimed at addressing the use case of services that require a prepayment of a mining fee in order for a non-custodian exchange to take place, such as submarine swaps and JIT channels.In the case of submarine swaps, some services can ask for a prepayment due to their software's ability to handle it, while others cannot. This creates a vulnerability for services like Boltz exchange, as they may be susceptible to denial-of-service (DoS) attacks where attackers force them to pay on-chain fees.JIT channel providers also face a similar mining fee attack risk and need to ask for the preimage of the main payment before opening the channel. However, this approach makes them custodians of the funds, which may have legal implications under European MICA regulation. Competitors who refuse to offer custodian services are excluded from the market.To address these issues, ThomasV proposes bundling the prepayment and main payment in the same BOLT-11 invoice. The proposal outlines the semantics of bundled payments, including having two preimages and amounts in the invoice. The receiver would wait for both payments' HTLCs to arrive before fulfilling the prepayment HTLCs. If the main payment does not arrive, the prepayment should fail with a MPP timeout. Once both payment HTLCs have arrived, the receiver fulfills the prepayment HTLCs and broadcasts the on-chain transaction. It is noted that the main payment can still fail if the sender never reveals the preimage.While the proposal does not prevent service providers from stealing the prepayment, ThomasV believes it would level the competition field between lightning service providers. Currently, using Loop requires a dedicated client, leaving competitors without an established user base exposed to mining fee attacks. The proposal could also benefit ACINQ by allowing them to make their pay-to-open service fully non-custodian, potentially avoiding European MICA regulation concerns.ThomasV emphasizes that the proposed change should be implemented in BOLT-11 rather than using BOLT-12 or onion messages. This is because the proposal does not necessitate the exchange of new messages and can be achieved in a non-interactive manner.Overall, ThomasV's proposal aims to address vulnerabilities and improve competition among lightning service providers by allowing two bundled payments in a BOLT-11 invoice.</summary>
    <published>2023-06-13T08:10:29+00:00</published>
  </entry>
</feed>
