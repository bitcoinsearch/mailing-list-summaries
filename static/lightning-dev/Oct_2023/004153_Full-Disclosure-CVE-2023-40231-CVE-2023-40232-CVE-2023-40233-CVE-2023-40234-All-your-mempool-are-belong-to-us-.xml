<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
  <updated>2023-10-21T01:55:35.752268+00:00</updated>
  <author>
    <name>Antoine Riard 2023-10-19 19:33:22+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
    <updated>2023-10-21T01:55:35.752295+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-October/004153.html" rel="alternate"/>
    <summary>In the email, Antoine discusses a scenario involving a replacement-cycling attacker who can afford to pay 100% of the HTLC (Hash Time Locked Contract) value under a defender scorched earth policy and still realize an economic gain. The example involves three individuals - Alice, Bob, and Caroll - who are targeted by the attacker.Alice has a 10,000 satoshi HTLC in-flight on her outbound channel. She broadcasts her HTLC-timeout at T + 1 with a committed fee of 10,000 sats. However, Mallory, the attacker, replaces it at T+2 with a HTLC-preimage X of 200,000 sats (+ rbf penalty 1 sat / vb rule 4).Bob also has a 10,000 satoshi HTLC in-flight and broadcasts his HTLC-timeout of 200,000 sats at T+3. Mallory replaces it at T+4 with her HLTC-preimage Y of 200,000 sats (+ rbf penalty 1 sat / vb rule 4 * 2). Both Alice's and Bob's HTLC-timeouts are out of network mempools.Caroll, the third victim, has a similar situation where her 10,000 satoshi HTLC is replaced by Mallory with a HTLC-preimage Z of 200,000 sats (+rbf penalty 1 sat / vb rule 4 * 3) at T+6.The HTLC-preimages Y and Z conflict with HTLC-preimage X due to the multiplied rbf penalty. Mallory aims to enter her HTLC-preimage into the top mempool feerates group to double-spend one unconfirmed ancestor and evict the HTLC-preimage.If Mallory succeeds in replacement cycling, she may incur a loss of 10,000 sats + rbf penalty cost for each rebroadcast attempt but would win the HTLC value of 200,000 sats from each victim (Alice, Bob, and Caroll). Assuming 5 rebroadcasts per block multiplied by 3 victims, with a 200-byte HTLC-preimage and cltv_delta of 144 blocks, the total attacker cost is 432,000 sats. The economic gain realized is 168,000 sats.Antoine expresses gratitude for checking the fees math and replacement rules, as it appears to be correct to him. He concludes by mentioning that without introducing more favorable assumptions to the attacker, such as mempool spikes, the additional victim cost remains at 144,000 sats regardless of the HTLC value targeted.</summary>
    <published>2023-10-19T19:33:22+00:00</published>
  </entry>
</feed>
