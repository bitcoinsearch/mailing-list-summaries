<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
  <updated>2023-10-19T01:54:12.892922+00:00</updated>
  <author>
    <name>Antoine Riard 2023-10-17 17:47:14+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
    <updated>2023-10-19T01:54:12.892955+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-October/004130.html" rel="alternate"/>
    <summary>The email discusses the possibility of a potential attack on Lightning Network (LN) channels and the measures taken to address this issue. The sender clarifies that no such attack has been observed on the mainnet, but there have been discussions and experiments conducted in restricted development circles to test the vulnerability.The attack targets channels with high capacity and loose channel policies. The flow affected is the total value of outbound HTLC (Hashed Time-Locked Contract) in-flight. To monitor the existence of such an attack, one can look at mempool logs and observe the amount of HTLC outputs being conflicted out with a specific sequence.The attack does not resemble a pinning attack, as it does not involve "honest" or "malicious" transactions pinned in network mempools. It can occur without network mempool congestion. The attacker can control two neighboring nodes to target the victim. By cycling the attack on the tail side and delaying the confirmation of the htlc-timeout covenant, the attacker can force-close the channel and claim their timeout-path, canceling back the initial htlc amount to their initial node.The email suggests testing this behavior and mentions that local-mempool preimage monitoring has been implemented by Eclair and LND as a mitigation against old school pinning attacks and replacement cycling attacks, respectively. However, Core-Lightning and LDK have not implemented this mechanism.The email also discusses a defensive fee mitigation strategy proposed in a paper. This strategy involves aggressively fee-bumping the htlc-output and racing it with the preimage claim on the incoming path. It is only feasible with anchor channels where fees can be added to the htlc-covenant. This would make the attack more costly for the peer, especially when fees up to 50% of the htlc value are used.However, the effectiveness of the attack depends on factors such as the amount and number of HTLCs for big channels to unknown peers. It may result in a heavy loss for the attacker when trying to steal small HTLCs.Overall, the email highlights the potential risks associated with certain LN channel configurations and proposes strategies to mitigate these risks.</summary>
    <published>2023-10-17T17:47:14+00:00</published>
  </entry>
</feed>
