<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
  <updated>2023-10-25T17:56:10.728041+00:00</updated>
  <author>
    <name>Antoine Riard 2023-10-17 17:47:14+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Full Disclosure: CVE-2023-40231 / CVE-2023-40232 / CVE-2023-40233 / CVE-2023-40234 "All your mempool are belong to us"</title>
    <updated>2023-10-25T17:56:10.728041+00:00</updated>
    <link href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-October/004130.html" rel="alternate"/>
    <summary>The email discusses the possibility of a potential attack on Lightning Network channels with high capacity and loose channel policies. The sender mentions that no such attack has been observed on the mainnet, but they have conducted a demo attack in restricted dev circles to experiment with different scenarios.

The risk of exposure exists if an attacker targets channels with high capacity and loose channel policies. There is no way to configure the cap for the total value of outbound HTLC (Hash Time Locked Contract) in-flight, which is the flow affected by the attack. To observe the existence of such an attack, one can look at mempool logs and observe the systematic conflict of HTLC outputs with a specific sequence (HTLC-timeout - HTLC-preimage - HTLC-timeout - ..).

The email clarifies that this attack is not akin to a pinning attack and can happen without network mempool congestion. The attacker can control two neighboring nodes to target the victim. By cycling the attack on the tail side and delaying the confirmation of the HTLC-timeout covenant, the peer at the front of the victim's channel will force-close the channel and claim their timeout-path, canceling back the initial HTLC amount to the attacker's initial node. This behavior is considered worthy of testing.

The email also mentions the implementation of Local-mempool preimage monitoring by Eclair and LND as a mitigation against old school pinning attacks and replacement cycling attacks. However, it is noted that Core-Lightning or LDK have not implemented this mechanism.

The sender suggests a defensive fee mitigation strategy where the attacker aggressively fee-bumps their HTLC-output and tries to grab the preimage and claim it on the incoming path. This is only feasible with anchor channels where fees can be added to the HTLC-covenant. The intention is to make the attack more costly for the peer, especially when fees are used up to 50% of the HTLC value. This defensive fee mitigation is proposed in a paper.

Overall, the email discusses the potential risks and strategies related to an attack on Lightning Network channels with high capacity and loose channel policies. The sender provides insights into monitoring, mitigation, and defensive fee strategies to counter such attacks.</summary>
    <published>2023-10-17T17:47:14+00:00</published>
  </entry>
</feed>
